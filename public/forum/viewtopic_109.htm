<!DOCTYPE html>
<!--[if lt IE 8]><html dir="ltr" lang="en-gb" class="ie oldie ie7"><![endif]-->
<!--[if IE 8]><html dir="ltr" lang="en-gb" class="ie oldie"><![endif]-->
<!--[if gt IE 8]><html dir="ltr" lang="en-gb" class="ie"><![endif]-->
<!--[if !(IE)]><!--><html dir="ltr" lang="en-gb"><!--<![endif]-->
<head>
	<meta charset="UTF-8">
	
	<link rel="alternate" type="application/atom+xml" title="Feed - TheLegendOfRandom.com" href="feed_2.php" /><link rel="alternate" type="application/atom+xml" title="Feed - All forums" href="feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="feed_3.php" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - R4ndom's Beginner Guide to Reverse Engineering" href="feed_6.php" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Help understanding memory modification" href="/forum/feed.php?f=2&amp;t=1658" />
<!--
   phpBB style name:    Artodia Black
   Based on style:      prosilver (this is the default phpBB3 style)
   Prosilver author:    Tom Beddard ( http://www.subBlue.com/ )
   Artodia Black author: Vjacheslav Trushkin ( http://www.artodia.com/ )

   NOTE: This page was generated by phpBB, the free open-source bulletin board package.
         The phpBB Group is not responsible for the content of this page and forum. For more information
         about phpBB please visit http://www.phpbb.com
-->
	<title>TheLegendOfRandom.com - View topic - Help understanding memory modification</title>
	<link rel="stylesheet" href="style.css?sid=d7ad04fab287729c29913a9b0e7a447d">
	
<script>

	var phpBB = {
		currentPage: '',
		themePath: './styles/art_black/theme',
		lang: 'en-gb'
	};

	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/; domain=.thelegendofrandom.com';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	};

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	};

</script>
<script src="styles/prosilver/template/forum_fn.js"></script>
</head>
<body class="phpbb section-viewtopic">

<div class="wrap-top" id="wrap">
	<div class="wrap-top-top"></div>
	<div class="wrap-top-mid"></div>
</div>

<div class="content-wrapper">
	<ul class="page-header">
		<li class="logo">
			<a href="../"><img src="styles/art_black/imageset/logo.png" alt="" title="" /></a>
		</li>
		<li class="site-title">
			<h1>TheLegendOfRandom.com</h1>
			<h2>Reverse Engineering and Programming</h2>
		</li>
	</ul>
	<div class="page-content">

		

		<ul class="menu left">
			<li class="nav-jumpbox"><a href="/forum/?sid=d7ad04fab287729c29913a9b0e7a447d" title="Board index" class="menu-home"><span>Board index</span></a></li>
			
				<li class="nav-forum "><a href="/forum/viewforum.php?f=1&amp;sid=d7ad04fab287729c29913a9b0e7a447d" class="menu-forum"><span>R4ndom's Forum</span></a></li>
			
				<li class="nav-forum  active"><a href="/forum/viewforum.php?f=2&amp;sid=d7ad04fab287729c29913a9b0e7a447d" class="menu-forum"><span>R4ndom's Beginner Guide to Reverse Engineering</span></a></li>
			
		</ul>

		<ul class="menu right">
			
				<li class="popup-trigger">
					<a href="/forum/search.php?sid=d7ad04fab287729c29913a9b0e7a447d" title="Search" class="menu-search"><span>Search</span></a>
					<div class="popup">
						<form action="/forum/search.php?sid=d7ad04fab287729c29913a9b0e7a447d" method="post">
						<fieldset class="nowrap">
							<input class="inputbox" type="text" name="keywords" maxlength="128" value="" required>
							<input class="button1" type="submit" value="Search">
						</fieldset>
						<input type="hidden" name="sid" value="d7ad04fab287729c29913a9b0e7a447d" />

						</form>
						<p class="right nowrap"><a class="link" href="/forum/search.php?sid=d7ad04fab287729c29913a9b0e7a447d">Advanced search</a></p>
					</div>
				</li>
			
			<li><a href="/forum/faq.php?sid=d7ad04fab287729c29913a9b0e7a447d" title="FAQ" class="menu-faq"><span>FAQ</span></a></li>
			
				<li class="popup-trigger">
					<a href="/forum/ucp.php?mode=login&amp;sid=d7ad04fab287729c29913a9b0e7a447d" class="menu-login"><span>Login <em>|</em> Register</span></a>
					<div class="popup">
						
							<form action="/forum/ucp.php?mode=login&amp;sid=d7ad04fab287729c29913a9b0e7a447d" method="post">
							<fieldset>
							<dl>
								<dt>Username:</dt>
								<dd><input class="inputbox" type="text" name="username" value="" required></dd>
							</dl>
							<dl>
								<dt>Password:</dt>
								<dd><input class="inputbox" type="password" name="password" value="" required></dd>
							</dl>
							<p class="nowrap right"><label><input type="checkbox" name="autologin"> Log me on automatically each visit</label></p>
							<p class="right">
								<input class="button1" type="submit" name="login" value="Login">
								 <a class="button2" href="/forum/ucp.php?mode=register&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Register</a>
							</p>
							
								<p class="right" style="display: none;" id="phpbb-sendpass">
									<span class="data-register">./ucp.php?mode=register&amp;sid=d7ad04fab287729c29913a9b0e7a447d</span>
									<span class="data-forgot">I forgot my password</span>
								</p>
							
							</fieldset>
							</form>
						
					</div>
				</li>
			
			<li class="popup-trigger"><a href="javascript:void(0);" class="menu-down"></a>
				<div class="popup popup-list"><ul>
					<li><a href="/forum/search.php?search_id=unanswered&amp;sid=d7ad04fab287729c29913a9b0e7a447d">View unanswered posts</a></li><li><a href="/forum/search.php?search_id=active_topics&amp;sid=d7ad04fab287729c29913a9b0e7a447d">View active topics</a></li>
				</ul></div>
			</li>
			
		</ul>
		
		<div class="clear"></div>
		
		
<h2 class="header"><a href="/forum/viewtopic.php?f=2&amp;t=1658&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Help understanding memory modification</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Anything having to do with R4ndom's Tutorials on Reverse Engineering.<br /></div>
<p>
	<strong>Moderators:</strong> <a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a>, <a href="/forum/memberlist.php?mode=viewprofile&amp;u=85&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">Rip06</a>
</p>


<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="/forum/posting.php?mode=reply&amp;f=2&amp;t=1658&amp;sid=d7ad04fab287729c29913a9b0e7a447d" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="search-box">
			<form method="get" id="topic-search" action="/forum/search.php?sid=d7ad04fab287729c29913a9b0e7a447d">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Search this topic…" onclick="if(this.value=='Search this topic…')this.value='';" onblur="if(this.value=='')this.value='Search this topic…';" />
				<input class="button2" type="submit" value="Search" />
				<input type="hidden" name="t" value="1658" />
<input type="hidden" name="sf" value="msgonly" />
<input type="hidden" name="sid" value="d7ad04fab287729c29913a9b0e7a447d" />

			</fieldset>
			</form>
		</div>
	
		<div class="pagination">
			9 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p3401" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3401">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="/forum/download/file.php?avatar=152_1342806625.jpg" width="86" height="86" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 19</dd><dd><strong>Joined:</strong> Fri Jul 20, 2012 5:45 pm</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 class="first"><a href="viewtopic_109.htm#p3401">Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3401&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3401"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></strong> &raquo; Fri Nov 09, 2012 10:50 pm </p>

			

			<div class="content">So I have been working on reading some memory addresses for a certain program included with windows in order to code a program to change the value, here is my sample code:<br /><dl class="codebox"><dt>Code: <a href="viewtopic_109.htm#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>int main() {<br />&nbsp; &nbsp;HWND hwnd; <br />&nbsp; &nbsp;HANDLE handle;<br />&nbsp; &nbsp;DWORD pid;<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;hwnd = FindWindow(0, &quot;Solitaire&quot;);<br />&nbsp; &nbsp;GetWindowThreadProcessId(hwnd,&amp;pid);<br />&nbsp; &nbsp;handle = OpenProcess(PROCESS_ALL_ACCESS, FALSE, pid);<br />&nbsp; &nbsp;<br />&nbsp; &nbsp;int buf1;<br />&nbsp; &nbsp;ReadProcessMemory(handle,(void *)0x00519250,&amp;buf1,sizeof(buf1),NULL);<br />&nbsp; &nbsp;printf(&quot;address found : %d\n&quot;, buf1); <br />&nbsp; &nbsp;<br />&nbsp; &nbsp;return 0;<br />}</code></dd></dl><br /><br />Of course, 0x00519250 is not the address I need. If I load up cheatengine i can see the image base and offset never changes. I'm not sure how to handle this, since I cannot seem to actually get any values. If i find the final position in memory and read that, i can change the value just fine. But I cannot simply figure out what to do with the base address that doesnt change. Do i read that value, then add offset 18 to it to get the true position in memory? I can't seem to figure out what the base is for soltiare.exe either, though. If i read just 00097074 I get 49367 (I tried this, since if i opened a handle i just figured it would know where to look). Perhaps reading it into an integer is my mistake. I know a pointer is going to hold an address, so if the pointer doesn't change and i know the offset doesn't change (18) i just need to find out what address the pointer contains. Still - I cannot seem to get anywhere with it. <br /><br />Can anyone give me a push in the right direction?</div>

			
				<div class="notice">Last edited by <a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a> on Wed Nov 14, 2012 1:35 am, edited 1 time in total.
					
				</div>
			

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3411" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3411">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="download/84.gif" width="90" height="90" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 214</dd><dd><strong>Joined:</strong> Wed Jul 11, 2012 6:12 am</dd><dd><strong>Location:</strong> The land of milk and honey</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3411">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3411&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3411"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></strong> &raquo; Sat Nov 10, 2012 2:36 pm </p>

			

			<div class="content">What are you trying to do? patch a memory value?  or more interested in the coding side of things?</div>

			<div id="sig3411" class="signature">&quot;To discover who rules you, look at who you can't criticize&quot;</div>

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3414" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3414">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="/forum/download/file.php?avatar=152_1342806625.jpg" width="86" height="86" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 19</dd><dd><strong>Joined:</strong> Fri Jul 20, 2012 5:45 pm</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3414">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3414&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3414"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></strong> &raquo; Sat Nov 10, 2012 4:01 pm </p>

			

			<div class="content"><blockquote><div><cite>nwokiller wrote:</cite>What are you trying to do? patch a memory value?  or more interested in the coding side of things?</div></blockquote><br /><br />I want to patch it, but for myself, not just to patch it and move on. I feel coding my own tools is going to help me in the long run with my malware analysis so I wanted to start here - reading memory. Since this value &quot;solitaire.exe&quot;+00097074&quot;  doesnt change - I should be able to use it to find the memory location on run without having to recompile my code with an updated address space each time... I just can't seem to get the right value from Memory. This is all related to his DLL injection tutorial - I just want to do more. Can I not use this method to inject code by writing over some other spots in the processes memory? I just figured this was a good start.</div>

			

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3419" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3419">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="download/84.gif" width="90" height="90" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 214</dd><dd><strong>Joined:</strong> Wed Jul 11, 2012 6:12 am</dd><dd><strong>Location:</strong> The land of milk and honey</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3419">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3419&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3419"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></strong> &raquo; Sat Nov 10, 2012 11:48 pm </p>

			

			<div class="content">I'm not the best coder and I see you're coding in C which I 'm really no good at, however would it be useful to use an API ike GetModueHandleA to get your base of code and then use an offset to read the memory value and store it/patch it? I do this with inlining and API hooking and it works really well. Using VirtualProtect API works really well also because you can trap where a section is having it's permissions changed and modify them  here too. Just a thought, the C coders here might be able to be more specific in relation to your code though.... <img src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /></div>

			<div id="sig3419" class="signature">&quot;To discover who rules you, look at who you can't criticize&quot;</div>

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3433" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3433">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="/forum/download/file.php?avatar=152_1342806625.jpg" width="86" height="86" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 19</dd><dd><strong>Joined:</strong> Fri Jul 20, 2012 5:45 pm</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3433">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3433&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3433"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></strong> &raquo; Sun Nov 11, 2012 4:13 pm </p>

			

			<div class="content"><blockquote><div><cite>nwokiller wrote:</cite>I'm not the best coder and I see you're coding in C which I 'm really no good at, however would it be useful to use an API ike GetModueHandleA to get your base of code and then use an offset to read the memory value and store it/patch it? I do this with inlining and API hooking and it works really well. Using VirtualProtect API works really well also because you can trap where a section is having it's permissions changed and modify them  here too. Just a thought, the C coders here might be able to be more specific in relation to your code though.... <img src="images/smilies/icon_razz.gif" alt=":P" title="Razz" /></div></blockquote><br /><br />can you demonstrate this? I also am not very good at C, im better in C++ and best in .Net languages\Java.</div>

			

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3437" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3437">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="download/84.gif" width="90" height="90" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 214</dd><dd><strong>Joined:</strong> Wed Jul 11, 2012 6:12 am</dd><dd><strong>Location:</strong> The land of milk and honey</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3437">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3437&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3437"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></strong> &raquo; Sun Nov 11, 2012 11:33 pm </p>

			

			<div class="content">I had a quick look at the exe  you mentioned, as with all exes the image base is in the header and the first &quot;GetModuleHandleA&quot; call retrieves this base in EAX, from there it should just be a matter of adding your offset... reading memory value and patching/storing.</div>

			<div id="sig3437" class="signature">&quot;To discover who rules you, look at who you can't criticize&quot;</div>

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3479" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3479">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="/forum/download/file.php?avatar=152_1342806625.jpg" width="86" height="86" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 19</dd><dd><strong>Joined:</strong> Fri Jul 20, 2012 5:45 pm</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3479">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3479&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3479"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></strong> &raquo; Tue Nov 13, 2012 8:27 pm </p>

			

			<div class="content"><blockquote><div><cite>nwokiller wrote:</cite>I had a quick look at the exe  you mentioned, as with all exes the image base is in the header and the first &quot;GetModuleHandleA&quot; call retrieves this base in EAX, from there it should just be a matter of adding your offset... reading memory value and patching/storing.</div></blockquote><br /><br />I gave it a try - but its not working. its apparent that my knowledge of WINAPI stops pretty soon - I guess I need to figure out exactly what else goes into it other than just knowing standard C++ - this feels like an entirely different beast. I'll work on it and get back to you once I manage to find some better tutorials\explanations on working with handles and other winAPI functions. I will explain some confusion I have, though. If i use the GetModuleHandleA I get a different address on each run of my program - which shouldn't be the case if the other program has not been touched, correct?<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic_109.htm#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>hWnd = FindWindow(NULL, &quot;Solitaire&quot;); //find solitaire window<br />&nbsp; &nbsp;GetWindowThreadProcessId(hWnd, &amp;dwID); //get the process PID based on the Window<br />&nbsp; &nbsp;hProcess = OpenProcess(PROCESS_ALL_ACCESS, NULL, dwID); //open a handle to the process<br />&nbsp; &nbsp;cout &lt;&lt; &amp;hProcess &lt;&lt; endl; //print handle to screen<br />&nbsp; &nbsp;bHandle = GetModuleHandleA(lpModuleName);<br />&nbsp; &nbsp;cout &lt;&lt; &amp;bHandle &lt;&lt; endl;<br /></code></dd></dl><br /><br />I get outputted: <br />001AFE90<br />001AFE84<br /><br />Clearly I am misunderstanding something. But if i Loop &amp; Sleep it reads out the same two for the duration of the program, so its unlikely its changing in between runs of my program.</div>

			

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3483" class="post bg1">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3483">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="download/84.gif" width="90" height="90" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 214</dd><dd><strong>Joined:</strong> Wed Jul 11, 2012 6:12 am</dd><dd><strong>Location:</strong> The land of milk and honey</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3483">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3483&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3483"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=84&amp;sid=d7ad04fab287729c29913a9b0e7a447d" style="color: #00AA00;" class="username-coloured">nwokiller</a></strong> &raquo; Tue Nov 13, 2012 11:16 pm </p>

			

			<div class="content">What OS are you using, if you're on Vista/7 then it's possible the program is using ASLR(If you load it in Olly and the base address changes between runs). Let me know exactly what you want to do here and I'll try and get you going in the right direction. below is a link ti info on ASLR from the blog<br /><!-- m --><a class="postlink" href="http://thelegendofrandom.com/blog/archives/1990">http://thelegendofrandom.com/blog/archives/1990</a><!-- m --></div>

			<div id="sig3483" class="signature">&quot;To discover who rules you, look at who you can't criticize&quot;</div>

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p3484" class="post bg2">
		<div class="inner"><span class="corners-top"><span></span></span>

		
		<div class="profile">
			<dl class="postprofile" id="profile3484">
			
			<dt class="popup-trigger">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></a>
				<div class="popup popup-list">
					<ul>
						<li><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Profile</a></li>
						
					</ul>
				</div>
			</dt>
			
			<dd class="poster-avatar">
				<a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d"><img src="/forum/download/file.php?avatar=152_1342806625.jpg" width="86" height="86" alt="User avatar" /></a>
			</dd>
			<dd><strong>Posts:</strong> 19</dd><dd><strong>Joined:</strong> Fri Jul 20, 2012 5:45 pm</dd>

		</dl>

		</div>
	

		<div class="postbody">
			

			<h3 ><a href="viewtopic_109.htm#p3484">Re: Help understanding memory modification</a></h3>
			<p class="author"><a href="/forum/viewtopic.php?p=3484&amp;sid=d7ad04fab287729c29913a9b0e7a447d#p3484"><img src="styles/art_black/imageset/icon_topic_latest.png" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="/forum/memberlist.php?mode=viewprofile&amp;u=152&amp;sid=d7ad04fab287729c29913a9b0e7a447d">RageMachine</a></strong> &raquo; Wed Nov 14, 2012 1:34 am </p>

			

			<div class="content"><blockquote><div><cite>nwokiller wrote:</cite>What OS are you using, if you're on Vista/7 then it's possible the program is using ASLR(If you load it in Olly and the base address changes between runs). Let me know exactly what you want to do here and I'll try and get you going in the right direction. below is a link ti info on ASLR from the blog<br /><!-- m --><a class="postlink" href="http://thelegendofrandom.com/blog/archives/1990">http://thelegendofrandom.com/blog/archives/1990</a><!-- m --></div></blockquote><br /><br />I finally figured it out, I thought I couldn't do it but I just kept working at it all day and I finally got some working code and a better understanding, just by hammering away at the documentation until I figured out what everything meant and got some return values on items. I am very tired, but here is my working(and messy) code:<br /><br /><dl class="codebox"><dt>Code: <a href="viewtopic_109.htm#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code>#include &lt;iostream&gt;<br />#include &lt;windows.h&gt;<br />#include &lt;Psapi.h&gt;<br />#include &lt;tchar.h&gt; <br />#include &lt;TlHelp32.h&gt;<br /><br />#pragma comment( lib, &quot;psapi&quot; )<br />using namespace std;<br /><br />int main() {<br />&nbsp; &nbsp;MODULEENTRY32 me32;<br />&nbsp; &nbsp;int pauser,mp,newscore;<br />&nbsp; &nbsp;HWND hWnd;//handle to a window or form<br />&nbsp; &nbsp;DWORD dwID; //PID of target<br />&nbsp; &nbsp;DWORD baseAddress; //32 bit unsigned integer<br />&nbsp; &nbsp;DWORD finalAddress;<br />&nbsp; &nbsp;HANDLE hProcess; //handle to the process in question<br />&nbsp; &nbsp;HANDLE testHandle;<br />&nbsp; &nbsp;const char* chModName = &quot;Solitaire.exe&quot;; <br />&nbsp; &nbsp;<br />&nbsp; &nbsp;hWnd = FindWindow(NULL, &quot;Solitaire&quot;); //find solitaire window<br />&nbsp; &nbsp;GetWindowThreadProcessId(hWnd, &amp;dwID); //get the process PID based on the Window<br />&nbsp; &nbsp;hProcess = OpenProcess(PROCESS_ALL_ACCESS, NULL, dwID); //open a handle to the process<br />&nbsp; &nbsp;cout &lt;&lt; &amp;hProcess &lt;&lt; endl; //print handle to screen<br />&nbsp; &nbsp;testHandle = CreateToolhelp32Snapshot(TH32CS_SNAPMODULE,dwID);<br />&nbsp; &nbsp;Module32First(testHandle,&amp;me32); //get first module information<br />&nbsp; &nbsp;baseAddress =&nbsp; (DWORD) me32.modBaseAddr; //set base address<br />&nbsp; &nbsp;baseAddress = baseAddress + 0x00097074; //add offset to get first pointer<br />&nbsp; &nbsp;cout &lt;&lt; baseAddress &lt;&lt; endl; //show pointer<br />&nbsp; &nbsp;ReadProcessMemory(hProcess,(LPVOID*)baseAddress,&amp;mp,4,0); //read the target of the pointer<br />&nbsp; &nbsp;cout &lt;&lt; &quot;INITIAL ADDRESS: &quot; &lt;&lt; hex &lt;&lt; mp &lt;&lt; endl; <br />&nbsp; &nbsp;baseAddress = mp + 0x2C; //add 2c to the target<br />&nbsp; &nbsp;cout &lt;&lt; &quot;NEXT ADDRESS: &quot; &lt;&lt; hex &lt;&lt; baseAddress &lt;&lt; endl;<br />&nbsp; &nbsp;ReadProcessMemory(hProcess,(LPVOID*)baseAddress,&amp;mp,4,0); //read next target<br />&nbsp; &nbsp;baseAddress = mp;<br />&nbsp; &nbsp;cout &lt;&lt; &quot;NEXT ADDRESS: &quot; &lt;&lt; hex &lt;&lt; baseAddress &lt;&lt; endl;<br />&nbsp; &nbsp;baseAddress = baseAddress + 0x18; //add 18 to the next pointer location<br />&nbsp; &nbsp;cout &lt;&lt; &quot;FINAL ADDRESS: &quot; &lt;&lt; hex &lt;&lt; baseAddress &lt;&lt; endl;<br />&nbsp; &nbsp;ReadProcessMemory(hProcess,(LPVOID*)baseAddress,&amp;mp,4,0); //show final score<br />&nbsp; &nbsp;cout &lt;&lt; &quot;Contents of Final Address: &quot; &lt;&lt; mp &lt;&lt; endl;<br />&nbsp; &nbsp;cout &lt;&lt; &quot;Write new value: &quot; &lt;&lt; endl;<br />&nbsp; &nbsp;cin &gt;&gt; newscore;<br />&nbsp; &nbsp;WriteProcessMemory(hProcess,(void*)baseAddress,&amp;newscore,sizeof(newscore),NULL); //write new score<br />&nbsp; &nbsp;system(&quot;Pause&quot;);<br />&nbsp; &nbsp;CloseHandle(testHandle);<br />&nbsp; &nbsp;CloseHandle(hProcess);<br />&nbsp; &nbsp;return 0;<br />}</code></dd></dl><br /><br />I ended up using CreateToolhelp32Snapshot(TH32CS_SNAPMODULE,dwID) but I feel I am wasting memory to return an entire structure for just one piece of info, but oh well, it works!</div>

			

		</div>
		
		<div class="back2top"><a href="viewtopic_109.htm#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="/forum/viewtopic.php?f=2&amp;t=1658&amp;sid=d7ad04fab287729c29913a9b0e7a447d">

	<fieldset class="display-options" style="margin-top: 0; ">
		
		<label>Display posts from previous: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
		<label>Sort by <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select> <input type="submit" name="sort" value="Go" class="button2" /></label>
		
	</fieldset>

	</form>


<div class="topic-actions">
	<div class="buttons">
	
		<div class="reply-icon"><a href="/forum/posting.php?mode=reply&amp;f=2&amp;t=1658&amp;sid=d7ad04fab287729c29913a9b0e7a447d" title="Post a reply"><span></span>Post a reply</a></div>
		
	</div>

	
		<div class="pagination">
			9 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="/forum/viewforum.php?f=2&amp;sid=d7ad04fab287729c29913a9b0e7a447d" class="left-box left" accesskey="r">Return to R4ndom's Beginner Guide to Reverse Engineering</a></p>

	<form method="post" id="jumpbox" action="/forum/viewforum.php?sid=d7ad04fab287729c29913a9b0e7a447d" onsubmit="if(this.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="1">R4ndom's Forum</option>
			
				<option value="11">&nbsp; &nbsp;Welcome</option>
			
				<option value="2" selected="selected">&nbsp; &nbsp;R4ndom's Beginner Guide to Reverse Engineering</option>
			
				<option value="20">&nbsp; &nbsp;Challenges</option>
			
				<option value="16">&nbsp; &nbsp;Questions and Answers</option>
			
				<option value="12">&nbsp; &nbsp;Modifying Binaries</option>
			
				<option value="9">&nbsp; &nbsp;Tools</option>
			
				<option value="21">&nbsp; &nbsp;Crackmes/Keygenmes</option>
			
				<option value="18">&nbsp; &nbsp;Other Tutorials</option>
			
				<option value="14">&nbsp; &nbsp;OllyDBG</option>
			
				<option value="10">&nbsp; &nbsp;Miscellaneous</option>
			
				<option value="7">&nbsp; &nbsp;About the site</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: <a href="/forum/memberlist.php?mode=viewprofile&amp;u=220851&amp;sid=d7ad04fab287729c29913a9b0e7a447d">aw48178903</a>, <a href="/forum/memberlist.php?mode=viewprofile&amp;u=245815&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Jozmraqb</a>, <a href="/forum/memberlist.php?mode=viewprofile&amp;u=254015&amp;sid=d7ad04fab287729c29913a9b0e7a447d">pshcf78qq</a>, <a href="/forum/memberlist.php?mode=viewprofile&amp;u=220843&amp;sid=d7ad04fab287729c29913a9b0e7a447d">radnsvxsw</a>, <a href="/forum/memberlist.php?mode=viewprofile&amp;u=248133&amp;sid=d7ad04fab287729c29913a9b0e7a447d">savelsswu</a>, <a href="/forum/memberlist.php?mode=viewprofile&amp;u=254017&amp;sid=d7ad04fab287729c29913a9b0e7a447d">xupfij29z</a> and 1 guest</p>

<div class="navbar">
	<div class="left">
		<a href="/forum/?sid=d7ad04fab287729c29913a9b0e7a447d">Board index</a>
	</div>
	
		<div class="right">
			<a href="/forum/ucp.php?mode=delete_cookies&amp;sid=d7ad04fab287729c29913a9b0e7a447d">Delete all board cookies</a>
			
		</div>
	
</div>


	</div><!-- content -->
</div><!-- wrap-content -->

<div class="footer"><div class="inner">
	
	<p class="copyright">
		<a href="http://www.phpbb.com/" class="phpbb-group" title="Powered by phpBB">Powered by phpBB&reg; Forum Software &copy; phpBB Group</a> 
<!--
    Please do not remove style author's link below. For updates and support visit http://www.artodia.com/
//-->
		<a href="http://www.artodia.com/" class="arty" title="phpBB style by Arty">phpBB style by Arty</a>
	</p>
	<div class="clear"><img src="forum/cron.php?cron_type=tidy_sessions&amp;sid=d7ad04fab287729c29913a9b0e7a447d" width="1" height="1" alt="cron" /></div>
</div></div>

<script src="styles/art_black/template/jquery-1.7.1.min.js"></script>
<script src="styles/art_black/theme/theme.js"></script>

	<script>
		phpBB.jumpBoxAction = './viewforum.php?sid=d7ad04fab287729c29913a9b0e7a447d';
		phpBB.jumpBoxData = [
			
			{
				'id'	: -1,
				'level'	 : ''
			},
			{
				'id'	: 1,
				'level'	 : ''
			},
			{
				'id'	: 11,
				'level'	 : '.'
			},
			{
				'id'	: 2,
				'selected'  : true,
				'level'	 : '.'
			},
			{
				'id'	: 20,
				'level'	 : '.'
			},
			{
				'id'	: 16,
				'level'	 : '.'
			},
			{
				'id'	: 12,
				'level'	 : '.'
			},
			{
				'id'	: 9,
				'level'	 : '.'
			},
			{
				'id'	: 21,
				'level'	 : '.'
			},
			{
				'id'	: 18,
				'level'	 : '.'
			},
			{
				'id'	: 14,
				'level'	 : '.'
			},
			{
				'id'	: 10,
				'level'	 : '.'
			},
			{
				'id'	: 7,
				'level'	 : '.'
			}
		];
	</script>
	
	<datalist id="jumpbox-data"><select id="jumpbox-data-select" style="display: none;">
		<option>Select a forum</option><option>R4ndom's Forum</option><option>Welcome</option><option>R4ndom's Beginner Guide to Reverse Engineering</option><option>Challenges</option><option>Questions and Answers</option><option>Modifying Binaries</option><option>Tools</option><option>Crackmes/Keygenmes</option><option>Other Tutorials</option><option>OllyDBG</option><option>Miscellaneous</option><option>About the site</option>
	</select></datalist>


</body>
</html>