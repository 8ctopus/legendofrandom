<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>DLL Injection – A Splash Bitmap «  The Legend Of Random</title>
<meta name="generator" content="WordPress 3.5.1">
<meta name="robots" content="follow, all">

<link rel="shortcut icon" href="http://thelegendofrandom.com/blog/wp-content/themes/jarrah/favicon.ico">
<link rel="stylesheet" href="1785_fichiers/style.css" type="text/css" media="screen">
<link rel="alternate" type="application/rss+xml" title="The Legend Of Random RSS Feed" href="http://thelegendofrandom.com/blog/feed">
<link rel="pingback" href="http://thelegendofrandom.com/blog/xmlrpc.php">
<link rel="stylesheet" href="1785_fichiers/menu.css" type="text/css" media="screen">
<!--[if IE]><link rel="stylesheet" href="http://thelegendofrandom.com/blog/wp-content/themes/jarrah/css/ie.css" type="text/css" media="screen" /><![endif]-->

<link rel="alternate" type="application/rss+xml" title="The Legend Of Random » DLL Injection – A Splash Bitmap Comments Feed" href="http://thelegendofrandom.com/blog/archives/1785/feed">
<script type="text/javascript" src="1785_fichiers/jquery.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var MyAjax = {"ajaxurl":"http:\/\/thelegendofrandom.com\/blog\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="text/javascript" src="1785_fichiers/ajax.js"></script>
<script type="text/javascript" src="1785_fichiers/comment-reply.js"></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://thelegendofrandom.com/blog/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://thelegendofrandom.com/blog/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="Gentle Introduction to Windows Assembly Language" href="http://thelegendofrandom.com/blog/archives/2907">
<link rel="next" title="The Real Workers Behind T.L.O.R." href="http://thelegendofrandom.com/blog/archives/2928">
<meta name="generator" content="WordPress 3.5.1">
<link rel="canonical" href="http://thelegendofrandom.com/blog/archives/1785">
<link rel="shortlink" href="http://thelegendofrandom.com/blog/?p=1785">
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<style type="text/css" id="syntaxhighlighteranchor"></style>

<script type="text/javascript" src="1785_fichiers/jquery_003.js"></script>
<script type="text/javascript" src="1785_fichiers/jquery_002.js"></script>
<script type="text/javascript" src="1785_fichiers/jquery_004.js"></script>
<script type="text/javascript" src="1785_fichiers/my-menu.js"></script>

<!-- this product is released under General Public License. Please see the attached file for details. You can also find details about the license at http://www.opensource.org/licenses/gpl-license.php -->
<script type="text/javascript">
/* <![CDATA[ */

jQuery(document).ready(function(){ 
    jQuery(document).pngFix(); 
});

/* ]]> */ 
</script>

</head>

<body>

<div id="wrapper" align="center">
	<div id="layouttop"></div>
    
    <!-- Header Starts -->
    <div id="header">
    	<div id="headerleft">
        	              	<h1><a href="http://thelegendofrandom.com/blog">The Legend Of Random</a> </h1><h3>Programming and Reverse Engineering</h3>
			      	   
        </div>
        <div id="headerright">
        	<div id="searchboxo">
        		<form method="get" id="searchform" action="http://thelegendofrandom.com/blog/">
    <input value="Search keywords" name="s" id="searchbox" onfocus="this.value=''" class="searchinput" type="text">
    <input class="submitbutton" value="" type="submit">
</form> 
            </div>
        </div>
    </div>
    <!-- Header Ends -->

    
    
    <div id="innerwrapper">
    	
        <!-- Main nav Starts here -->
        <div id="navouter">
            <div id="nav">

                                <ul class="lavalamp" id="menu1">
                <li class="page_item "><a href="file:///Y:/thelegendofrandom.com/site/thelegendofrandom.com/blog/index.html">Home</a> </li>
                <li class="page_item page-item-2"><a href="file:///Y:/thelegendofrandom.com/site/thelegendofrandom.com/blog/sample-page.html">Tutorials</a> </li>
<li class="page_item page-item-27"><a href="file:///Y:/thelegendofrandom.com/site/thelegendofrandom.com/blog/tools.html">Tools</a> </li>
<li class="page_item page-item-153"><a href="file:///Y:/thelegendofrandom.com/site/thelegendofrandom.com/blog/contact-2.html">Contact</a> </li>
<li class="page_item page-item-846"><a href="http://www.thelegendofrandom.com/forum/">Forum</a> </li>
<li class="page_item page-item-1790"><a href="file:///Y:/thelegendofrandom.com/site/thelegendofrandom.com/blog/challenges.html">Challenges</a> </li>
			
                <li style="left: 12px; width: 58px;" class="back"><div class="left"></div></li></ul>
            
            </div>
        </div>
        <!-- Main nav Ends -->
<div id="maincol">
		
        <div class="postwrap">
          	<h2 class="posttitle"><a href="http://thelegendofrandom.com/blog/archives/1785">DLL Injection – A Splash Bitmap</a> </h2>
          	<div class="postmeta">by <a href="http://thelegendofrandom.com/blog/archives/author/random" title="Posts by R4ndom" rel="author">R4ndom</a>  on Oct.02, 2012, under <a href="http://thelegendofrandom.com/blog/archives/category/intermediate" title="View all posts in Intermediate" rel="category tag">Intermediate</a> , <a href="http://thelegendofrandom.com/blog/archives/category/modifying-binaries" title="View all posts in Modifying Binaries" rel="category tag">Modifying Binaries</a> , <a href="http://thelegendofrandom.com/blog/archives/category/tutorials" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
            <div class="clr16"></div>
          	<div class="postcontent"><p>There are a couple ways of 
injecting a splash screen into a binary. Unfortunately, none of them 
easy. The way I will show in this tutorial is the easiest I’ve come 
across, though there may be simpler options out there. The problem 
arises from the fact that a bitmap is a resource, and as such, goes in 
the resources section of a binary. Injecting resources into a compiled 
binary’s resource section is a recipe for a quick headache.</p>
<p>The method we’ll be using is to create a DLL file with the resource 
included in it, and then call this DLL from our target binary. Because 
it’s a DLL, we can load it automatically by changing very little in the 
binary, as we can just add it to the list of DLLs the binary requires. 
This also gives us the benefit of running the code in our DLL 
automatically instead of having to create a code cave.</p>
<p style="text-align: left;">In this tutorial we will be creating a DLL from scratch using assembly, so you will need an assembly language compiler. I use <a href="http://www.oby.ro/rad_asm/"><span style="text-decoration: underline; color: #0a77e1;">RadASM</span></a> </p>
 (and it will be more convenient if you use this IDE as well as your 
code will exactly match mine), but it is not a requirement. If you are 
not comfortable using RadASM and want to learn, please see my series of 
tutorials on RadASM on the <a title="Tutorials" href="http://thelegendofrandom.com/blog/sample-page"><span style="text-decoration: underline; color: #0a77e1;">tutorials</span></a>  page, which comes with a full download of the RadASM suite and everything you need to run it.<p></p>
<p style="text-align: left;">As with all of my tutorials, the required files for this tutorial are in the downloads, available on the <a title="Tutorials" href="http://thelegendofrandom.com/blog/sample-page"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a> </p> page. In addition to these files, we will be using IIDKing, available on the <a title="Tools" href="http://thelegendofrandom.com/blog/tools"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tools</span></span></a>  page.<p></p>
<p style="text-align: left;">If you haven’t already read my previous <a title="Tutorials" href="http://thelegendofrandom.com/blog/sample-page"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a> </p> on modifying binaries, I highly recommend you do (at least the <a href="http://thelegendofrandom.com/blog/archives/1656"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorial</span></span></a>  on injecting a message box).<p></p>
<p style="text-align: left;"><span id="more-1785"></span></p>
<h2><span style="color: #0a77e1;">Introduction</span></h2>
<p>We will be inserting a splash screen in a simple program so as not to
 get caught up in the details. We will display the splash picture for 5 
seconds, or until the user presses a mouse button. This means we will 
need message handlers in our DLL for mouse and timer events.</p>
<p>Because this splash screen is a Window’s window, we will have to 
register it with the operating system, and all the code that entails. 
This means the DLL will need a WinMain to create and display the window 
and a WndProc to handle the messages.</p>
<p>Also, as this is a DLL, we will need to create an export file (see previous modifying binaries tutorial).</p>
<h2><span style="color: #0a77e1;">Starting the DLL</span></h2>
<p>First, we will create the DLL entry function. This function will be 
called automatically when the DLL is loaded by the target binary. To 
make Windows do this, we will add a section for the DLL_PROCESS_ATTACH 
callback. Doing this runs our entry code when the DLL attaches to the 
binary, in other words, when it is loaded into the binary’s memory 
space. Open up your assembly IDE (or Notepad as the case may be) and 
start a new DLL project named Splash.</p>
<p><em>Note: In RadASM, select “New Project”. Select Dll Project and 
enter the name “Splash”. Click Next, Next, un-check the include and bak 
files and check the .rc file, Next, Check Compile-rc, Finish. We now 
have a DLL project ready to go.</em></p>
<p><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/179.png"><img class="aligncenter size-full wp-image-2866" title="Dll project" src="1785_fichiers/179.png" alt="" height="133" width="141"></a> </p><p></p>
<p>Now open the Splash.Asm file and enter the initial code (remember, a 
copy of all of these files is included in the download, so save yourself
 from typing…):</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/240.png"><img class="aligncenter  wp-image-2867" title="Initial code" src="1785_fichiers/240.png" alt="" height="465" width="459"></a> </p><p></p>
<p>Here we simply load our imports and declare our variables.</p>
<p>Next comes the actual DLLEntry code:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/335.png"><img class="aligncenter  wp-image-2869" title="Entry function" src="1785_fichiers/335.png" alt="" height="195" width="462"></a> </p><p></p>
<p>This function simply saves the handle of the window and calls our 
main function, ShowBitmap. We could have entered our ShowBitmap code 
directly into this function, but calling it from here makes the code 
easier to read. It then returns true, regardless of if our code is 
called or not, per the Windows API instructions for DllEntry.</p>
<p>Next, we must make our main function to show the bitmap window:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/11.png"><img class="aligncenter  wp-image-2913" title="Main window class" src="1785_fichiers/11.png" alt="" height="533" width="460"></a> </p><p></p>
<p>This is the standard Windows code to set up a new window.</p>
<p>Now we start with the main displaying of our bitmap, the WndProc 
class. This class sets up the window, loads the bitmap and displays it, 
and then waits for 5 seconds or a mouse click. First, the locals:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/530.png"><img class="aligncenter  wp-image-2872" title="locals" src="1785_fichiers/530.png" alt="" height="213" width="540"></a> </p><p></p>
<p>The first message we will handle is the destroy message. Here we 
delete the bitmap object and close our window in the case of our window 
terminating:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/628.png"><img class="aligncenter  wp-image-2871" title="destroy" src="1785_fichiers/628.png" alt="" height="100" width="572"></a> </p><p></p>
<p>Now we actually load in our bitmap into the device context, as well as set the timer:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/722.png"><img class="aligncenter  wp-image-2873" title="create" src="1785_fichiers/722.png" alt="" height="426" width="594"></a> </p><p></p>
<p>We then implement our timer message handler:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/820.png"><img class="aligncenter  wp-image-2874" title="timer" src="1785_fichiers/820.png" alt="" height="85" width="580"></a> </p><p></p>
<p>This simply kills our timer if the timer goes off or if a mouse is clicked.</p>
<p>Next we display our bitmap (copying it into our window):</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/916.png"><img class="aligncenter  wp-image-2875" title="paint" src="1785_fichiers/916.png" alt="" height="238" width="556"></a> </p><p></p>
<p>Finally, we handle the mouse click and the default messages our function won’t handle, as well as end our procedure:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/1021.png"><img class="aligncenter  wp-image-2876" title="ending the procedure" src="1785_fichiers/1021.png" alt="" height="211" width="561"></a> </p><p></p>
<p>That covers the DLL’s code. Now we must load our bitmap into the 
resource section of the DLL. In RadASM, we simply add a new resource, 
but if you’re not using RadASM, use whatever method is appropriate. I 
have included a bitmap in the download of this tutorial, but please feel
 free to use any bitmap you wish. We will call the bitmap MyBitmap (in 
RadASM click Project-&gt;Resource):</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/180.png"><img class="aligncenter  wp-image-2878" title="adding the resource" src="1785_fichiers/180.png" alt="" height="299" width="509"></a> </p><p></p>
<p>For anyone adding the resource manually, here is the Splash.rc file:</p>
<p><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/241.png"><img class="aligncenter size-full wp-image-2879" title="the resource file" src="1785_fichiers/241.png" alt="" height="92" width="469"></a> </p><p></p>
<p>Now that the resource is loaded into the resource section we need to 
implement our .DEF file where we list the functions available as 
exports. Open the Splash.def file and enter the following:</p>
<p><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/1316.png"><img class="aligncenter size-full wp-image-2736" title="export file" src="1785_fichiers/1316.png" alt="" height="124" width="588"></a> </p><p></p>
<p>Here we name the DLL and provide the two functions for export. Your project folder should now contain the following files:</p>
<p><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/184.png"><img class="aligncenter size-full wp-image-2880" title="Project folder" src="1785_fichiers/184.png" alt="" height="155" width="122"></a> </p><p></p>
<h2><span style="color: #0a77e1;">Building the DLL</span></h2>
<p>Now try building your project. If all goes well you should have additional files in your project folder:</p>
<p><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/242.png"><img class="aligncenter size-full wp-image-2881" title="New files" src="1785_fichiers/242.png" alt="" height="252" width="131"></a> </p><p></p>
<p>This includes the actual “splash.dll” file named in the .DEF export file.</p>
<p><span style="color: #07e4f7;"><em>Note: It took me about 4 days to 
figure out why RadASM was giving me troubles with this project. 
Basically, the resource bitmap would not be compiled in to the resource 
file. I finally found out how to fix this, and if you are using RadASM, 
you must do this as well…</em></span></p>
<p><span style="color: #07e4f7;"><em>1. Select Project-&gt;Project Options. This opens the compile options for our project:</em></span></p>
<p style="text-align: center;"><span style="color: #07e4f7;"><em><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/336.png"><span style="color: #07e4f7;"><img class="aligncenter  wp-image-2882" title="Compile options" src="1785_fichiers/336.png" alt="" height="448" width="548"></span></a> </em></span></p><p></p>
<p><span style="color: #07e4f7;"><em>Notice the “Link” line in the red 
box. We must include our resource file in the compilation of this DLL. 
Without this, our bitmap will show as a blank window. To fix this, first
 click the “Main Files” button, which shows the files and shortcuts 
RadASM uses in the command lines:</em></span></p>
<p style="text-align: center;"><span style="color: #07e4f7;"><em><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/433.png"><span style="color: #07e4f7;"><img class="aligncenter  wp-image-2884" title="Main files in RadASM" src="1785_fichiers/433.png" alt="" height="229" width="236"></span></a> </em></span></p><p></p>
<p><span style="color: #07e4f7;"><em>Look for the “Splash.res” file and 
note the shortcut for it, denoted with a dollar sign. In my example, it 
is “$4″. Now close this window and add the following in to the link 
field:</em></span></p>
<p style="text-align: center;"><span style="color: #07e4f7;"><em><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/531.png"><span style="color: #07e4f7;"><img class="aligncenter  wp-image-2883" title="Adding the resource option" src="1785_fichiers/531.png" alt="" height="62" width="601"></span></a> </em></span></p><p></p>
<p><span style="color: #07e4f7;"><em>replacing the $4 with whatever 
shortcut your .res file was. You can also copy the following line and 
paste it into your link field, replacing the $4 with your appropriate 
shortcut:</em></span></p>
<p><span style="color: #07e4f7;"><em>7,O,$B\LINK.EXE /SUBSYSTEM:WINDOWS /RELEASE /DLL /DEF:$6 /LIBPATH:”$L” “$4″ /OUT:”$7″,3</em></span></p>
<p><span style="color: #07e4f7;"><em>Now, when you compile your DLL, the bitmap should be included. Go ahead and build it now. </em></span></p>
<p><span style="color: #07e4f7;"><em>AND PLEASE: if anyone knows the reason for this, please email me or post it on the site.</em></span></p>
<p>If you recall from the last tutorial on injecting a message box, we 
can test the DLL at this point to make sure it works. To do this we will
 use the rundll32 program provided by Windows. Open a command prompt and
 enter the following:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/09/629.png"><img class="aligncenter  wp-image-2890" title="running the DLL" src="1785_fichiers/629.png" alt="" height="302" width="606"></a> </p><p></p>
<p>When you execute this command, you should see the DLL splash pop up 
for 5 seconds and then go away. The image will then pop up for an 
additional 5 seconds and then the dll will end. The reason for it 
showing twice is that, when using rundll32.exe, the DLL is called both 
when it is loaded and again when it is released.</p>
<h2><span style="color: #0a77e1;">Injecting the DLL</span></h2>
<p>Now that we have a compiled DLL containing our bitmap, it is time to 
inject it. We could do this by hand, but there really is no need. We can
 simply use IIDKing to inject it. Go ahead and run IIDKing:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/1.png"><img class="aligncenter  wp-image-2911" title="IIDKing" src="1785_fichiers/1.png" alt="" height="288" width="418"></a> </p><p></p>
<p>Now we need to pick a file to inject. I chose a simple freeware color
 picker (included in the download of this tutorial), but you can use any
 32-bit program. Copy the splash.dll file we made into the same 
directory as your target (colorpicker.exe). Now click on “Pick a file” 
and select your target:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/0.png"><img class="aligncenter  wp-image-2915" title="Loading the target" src="1785_fichiers/0.png" alt="" height="288" width="418"></a> </p><p></p>
<p>I usually keep the backup option selected so I don’t mess anything up
 (which is pretty easy to do when messing with binaries like this!) Now 
click the “Click to pick DLL(s)…” button and select the splash.dll file 
from the same directory as your target. When you do, the name will 
appear in the Name field and IIDKing will ask which functions you wish 
to import:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/12.png"><img class="aligncenter  wp-image-2916" title="Select the function to import" src="1785_fichiers/12.png" alt="" height="288" width="418"></a> </p><p></p>
<p>I will select both of them (even though really we only need to import the ShowBitmap function), then select “Add them!”:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/2.png"><img class="aligncenter  wp-image-2917" title="Functions imported" src="1785_fichiers/2.png" alt="" height="288" width="418"></a> </p><p></p>
<p>Now we can see that we are including both functions from the 
splash.dll file. Now go ahead and click “Add them!” on the main screen 
and if all goes well you should see a success message:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/3.png"><img class="aligncenter  wp-image-2918" title="Success message" src="1785_fichiers/3.png" alt="" height="193" width="446"></a> </p><p></p>
<p>As soon as you click OK, the new version of your target will be 
saved, a backup will be saved with a .bak extension, and a file will be 
created with an exe.txt extension letting us know exactly what IIDKing 
did. Go ahead and open this file:</p>
<p><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/4.png"><img class="aligncenter size-full wp-image-2919" title="The IIDKing file" src="1785_fichiers/4.png" alt="" height="181" width="566"></a> </p><p></p>
<p>This information will be very helpful in future tutorials as it tells
 us exactly which address we must call to access our functions. Because 
we call our functions automatically when the DLL is loaded, we don’t 
have to worry about it in this tutorial. But for the future, if you open
 our target in Olly you can see what has been added:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/5.png"><img class="aligncenter  wp-image-2920" title="Added functions in Olly" src="1785_fichiers/5.png" alt="" height="257" width="406"></a> </p><p></p>
<p>Here, we can see that our functions have been added to the IAT (you 
must analyze this section to show it properly- I used AnalyzeThis!). So 
these functions are now available to our target. Now go ahead and run 
the target (in or out of Olly) and you will see our splash displayed:</p>
<p style="text-align: center;"><a href="http://thelegendofrandom.com/blog/wp-content/uploads/2012/10/13.png"><img class="aligncenter  wp-image-2921" title="Running the target" src="1785_fichiers/13.png" alt="" height="288" width="378"></a> </p><p></p>
<p>You can either wait five seconds (which you’ll probably want to do to
 see the bitmap in all its glory) or click on the splash to then run our
 target. We have now successfully injected a splash screen into a 
binary!!!</p>
<p>-Till next time</p>
<p>R4ndom</p>
</div>
          	<div class="clr"></div>
          	<span class="linkpages"></span><div class="cleared"></div>
          	
			            
				<div class="roundcornrrbox">
                   	<div class="topleftcorner"><div class="toprightcorner"></div></div>
                    <div class="roubcornrcontent">
            			<span class="posttags-single">No tags</span>
                    	<div class="clr"></div>
                    </div>
                    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
                </div>                        
                        
			
			        	
            <div class="clr"></div>
        </div> <!-- Closes topPost -->
		<small></small>

		<div id="comments">
			            <!-- WP 2.7 and above -->
            <div class="roundcornrrbox">
	<div class="topleftcorner"><div class="toprightcorner"></div></div>
	<div class="roubcornrcontent">

		<h3 id="commentstitle">3 Comments for this entry</h3>
	<ul class="commentlist">
		   <li class="comment even thread-even depth-1" id="li-comment-5529">
     <div id="comment-5529">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt="" src="1785_fichiers/aa174f4daacf5a00e218828cbb5a71e8.png" class="avatar avatar-60 photo" height="60" width="60">                </a>             
            
			<cite>qreck</cite> 
						<br>
			<small class="commentmetadata"><a href="#comment-5529" title="">October 14th, 2012 on 9:24 pm</a>  </small>

			<p>What is the purpose of injecting a bmp splash screen. Is their something nor sinister to leverage with this hack?</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class="comment-reply-link" href="http://thelegendofrandom.com/blog/archives/1785?replytocom=5529#respond" onclick='return addComment.moveForm("comment-5529", "5529", "respond", "1785")'>Reply</a>       </div>
     </div>
<ul class="children">
   <li class="comment byuser comment-author-random bypostauthor odd alt depth-2" id="li-comment-5534">
     <div id="comment-5534">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt="R4ndom" src="1785_fichiers/R4ndom_avatar-60x60.png" class="avatar avatar-60 photo" height="60" width="60">                </a>             
            
			<cite>R4ndom</cite> 
						<br>
			<small class="commentmetadata"><a href="#comment-5534" title="">October 14th, 2012 on 10:39 pm</a>  </small>

			<p>Pranks on co-workers, of course.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class="comment-reply-link" href="http://thelegendofrandom.com/blog/archives/1785?replytocom=5534#respond" onclick='return addComment.moveForm("comment-5534", "5534", "respond", "1785")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment byuser comment-author-tarequl-crack even thread-odd thread-alt depth-1" id="li-comment-8239">
     <div id="comment-8239">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt="tarequl.crack" src="1785_fichiers/tarequl.jpg" class="avatar avatar-60 photo" height="60" width="60">                </a>             
            
			<cite>tarequl.crack</cite> 
						<br>
			<small class="commentmetadata"><a href="#comment-8239" title="">November 25th, 2012 on 4:56 am</a>  </small>

			<p>How can we use picture other than .bmp</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class="comment-reply-link" href="http://thelegendofrandom.com/blog/archives/1785?replytocom=8239#respond" onclick='return addComment.moveForm("comment-8239", "8239", "respond", "1785")'>Reply</a>       </div>
     </div>
</li>
	</ul>
	
	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
		<div class="cleared"></div>
	</div>

	

 
<div class="clr"></div>
<div id="respond">
<h3>Leave a Reply</h3>
<div id="cancel-comment-reply">
	<small><a rel="nofollow" id="cancel-comment-reply-link" href="http://thelegendofrandom.com/blog/archives/1785#respond" style="display:none;">Click here to cancel reply.</a> </small>
</div>
 
<form action="http://thelegendofrandom.com/blog/wp-comments-post.php" method="post" id="commentform">


<p><input name="author" id="author" size="22" tabindex="1" type="text">
<label for="author"><small>Name </small></label></p>
<p><input name="email" id="email" size="22" tabindex="2" type="text">
<label for="email"><small>Mail (will not be published) </small></label></p>
<p><input name="url" id="url" size="22" tabindex="3" type="text">
<label for="url"><small>Website</small></label></p>

 <input name="comment_post_ID" value="1785" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">

<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->
<p><textarea name="comment" id="comment" cols="56" rows="10" tabindex="4"></textarea></p>
<p><input name="submit" id="submit" class="submitbutton" tabindex="5" value="Leave comment" type="submit">
<input name="comment_post_ID" value="1785" type="hidden">
</p>

<p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="3952e1fc3a" type="hidden"></p> 
</form>
</div>
 
    </div>
    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
</div>            
                    </div> <!-- Closes Comment -->

<div id="extrastuff">
<span id="rssleft"><a href="http://thelegendofrandom.com/blog/archives/1785/feed"><abbr title="Really Simple Syndication">RSS</abbr> feed for this post (comments)</a> </span>

<span id="trackright"> · <a href="http://thelegendofrandom.com/blog/archives/1785/trackback" rel="trackback">TrackBack <abbr title="Uniform Resource Identifier">URI</abbr></a> </span>
<div class="cleared"></div>
</div>


</div><!-- Closes Main -->


<div id="rightcol">
	<div class="roundcornrrbox">
    <div class="topleftcorner"><div class="toprightcorner"></div></div>
    <div class="roundcrrcnt">
        <!-- Optional Intro -->
                
        <!-- widget -->



<h2>Login</h2>
<form action="http://thelegendofrandom.com/blog/wp-login.php" method="post">
<input name="log" id="log" size="20" type="text">
<input name="pwd" id="pwd" size="20" type="password">
<input name="submit" value="Send" class="button" type="submit">
    <p>
       <label for="rememberme"><input name="rememberme" id="rememberme" checked="checked" value="forever" type="checkbox"> Remember me</label>
       <input name="redirect_to" value="/blog/archives/1785" type="hidden">
    </p>
</form>
<a href="http://thelegendofrandom.com/blog/wp-login.php?action=lostpassword">Recover password</a> 



        		<li id="recent-posts-2" class="sidebaritem widget_recent_entries"><div class="sidebarbox">		<h2 class="widgettitle">Recent Posts</h2>		<ul>
					<li>
				<a href="http://thelegendofrandom.com/blog/archives/2980" title="My Absence">My Absence</a> 
						</li>
					<li>
				<a href="http://thelegendofrandom.com/blog/archives/2975" title="What Are These Strange Posts?">What Are These Strange Posts?</a> 
						</li>
					<li>
				<a href="http://thelegendofrandom.com/blog/archives/2966" title="Nice Beginning Article on Reversing Android">Nice Beginning Article on Reversing Android</a> 
						</li>
					<li>
				<a href="http://thelegendofrandom.com/blog/archives/2963" title="She Is 17-years-old, She Did It Publicly In High School And While Drunk">She Is 17-years-old, She Did It Publicly In High School And While Drunk</a> 
						</li>
					<li>
				<a href="http://thelegendofrandom.com/blog/archives/2961" title="And The Most Posts Submitted In A Single Sitting Goes To…">And The Most Posts Submitted In A Single Sitting Goes To…</a> 
						</li>
				</ul>
		</div></li><li id="recent-comments-2" class="sidebaritem widget_recent_comments"><div class="sidebarbox"><h2 class="widgettitle">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments">tip on <a href="http://thelegendofrandom.com/blog/archives/1722#comment-85953">A New Tutorial by Xor06 : Bypassing a Server Check</a> </li><li class="recentcomments">tip on <a href="http://thelegendofrandom.com/blog/archives/2418#comment-85946">R4ndom’s Tutorial #23: TLS Callbacks</a> </li><li class="recentcomments">C4lculated on <a href="http://thelegendofrandom.com/blog/archives/1472#comment-85945">R4ndom’s Tutorial #17: Working With Delphi Binaries</a> </li><li class="recentcomments"><a href="http://rce-loverz.tk/" rel="external nofollow" class="url">X-Programmer</a>  on <a href="http://thelegendofrandom.com/blog/archives/7#comment-85935">Tutorial #1 : What is Reverse Engineering</a> </li><li class="recentcomments">shub on <a href="http://thelegendofrandom.com/blog/archives/859#comment-85873">R4ndom’s Tutorial #9: Solution</a> </li></ul></div></li><li id="archives-2" class="sidebaritem widget_archive"><div class="sidebarbox"><h2 class="widgettitle">Archives</h2>		<ul>
			<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/10" title="October 2012">October 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/09" title="September 2012">September 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/08" title="August 2012">August 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/07" title="July 2012">July 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/06" title="June 2012">June 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/05" title="May 2012">May 2012</a> </li>
		</ul>
</div></li><li id="categories-2" class="sidebaritem widget_categories"><div class="sidebarbox"><h2 class="widgettitle">Categories</h2>		<ul>
	<li class="cat-item cat-item-23"><a href="http://thelegendofrandom.com/blog/archives/category/beginner" title="View all posts filed under Beginner">Beginner</a> 
</li>
	<li class="cat-item cat-item-31"><a href="http://thelegendofrandom.com/blog/archives/category/challenges" title="View all posts filed under Challenges">Challenges</a> 
</li>
	<li class="cat-item cat-item-24"><a href="http://thelegendofrandom.com/blog/archives/category/intermediate" title="View all posts filed under Intermediate">Intermediate</a> 
</li>
	<li class="cat-item cat-item-32"><a href="http://thelegendofrandom.com/blog/archives/category/modifying-binaries" title="View all posts filed under Modifying Binaries">Modifying Binaries</a> 
</li>
	<li class="cat-item cat-item-25"><a href="http://thelegendofrandom.com/blog/archives/category/randoms-ramblings" title="View all posts filed under Random's Ramblings">Random's Ramblings</a> 
</li>
	<li class="cat-item cat-item-3"><a href="http://thelegendofrandom.com/blog/archives/category/reverse-engineering" title="View all posts filed under Reverse Engineering">Reverse Engineering</a> 
</li>
	<li class="cat-item cat-item-4"><a href="http://thelegendofrandom.com/blog/archives/category/tools" title="View all posts filed under Tools">Tools</a> 
</li>
	<li class="cat-item cat-item-5"><a href="http://thelegendofrandom.com/blog/archives/category/tutorials" title="View all posts filed under Tutorials">Tutorials</a> 
</li>
	<li class="cat-item cat-item-1"><a href="http://thelegendofrandom.com/blog/archives/category/uncategorized" title="View all posts filed under Uncategorized">Uncategorized</a> 
</li>
		</ul>
</div></li><li id="meta-2" class="sidebaritem widget_meta"><div class="sidebarbox"><h2 class="widgettitle">Meta</h2>			<ul>
			<li><a href="http://thelegendofrandom.com/blog/wp-login.php?action=register">Register</a> </li>			<li><a href="http://thelegendofrandom.com/blog/wp-login.php">Log in</a> </li>
			<li><a href="http://thelegendofrandom.com/blog/feed" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a> </li>
						<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a> </li>
						</ul>
</div></li><li id="ajax-quick-subscribe" class="sidebaritem widget_quick_subscribe"><div class="sidebarbox"><h2 class="widgettitle">Subscribe</h2>Enter your email to subscribe to future updates<div id="QSWidgetDiv" class="QSWidgetDiv"><form name="widget_quick_subscribe_form" id="widget_quick_subscribe_form"><input name="QS_user_email_widget" id="QS_user_email_widget" placeholder="email@email.com" onfocus='fadeSubmitIn("widget_qsSubmit");' onblur='fadeSubmitOut(this, "widget_qsSubmit");' onkeypress='return checkForEnter(event, "QS_user_email_widget", "QSWidgetDiv"); return false;' type="email"><input style="display:none;" value="subscribe!" id="widget_qsSubmit" class="widget_qsSubmit" onclick='submitQuickSubscribe("QS_user_email_widget", "QSWidgetDiv");' type="button"></form></div>			
			</div></li> 

        <div class="clr"></div>

    	<div id="feedbox">
            <div id="contrssbox">
                <a href="http://thelegendofrandom.com/blog/feed">RSS Feed</a> 
            </div>
        </div>
        


    </div>
    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
</div>
</div>
<div class="clr"></div>




    
	<div id="bottompanel">
    <div class="roundcornrrbox">
        <div class="topleftcorner"><div class="toprightcorner"></div></div>
        <div class="roundcrrcnt">
        
        	
            <div class="col1">
                
					                    <h3>Recent Posts</h3>
                    <ul>
                                                    <li>
                                <a href="http://thelegendofrandom.com/blog/archives/2980">My Absence </a> 
                            </li>
                                                    <li>
                                <a href="http://thelegendofrandom.com/blog/archives/2975">What Are These Strange Posts? </a> 
                            </li>
                                                    <li>
                                <a href="http://thelegendofrandom.com/blog/archives/2966">Nice Beginning Article on Reversing Android </a> 
                            </li>
                                                    <li>
                                <a href="http://thelegendofrandom.com/blog/archives/2963">She Is 17-years-old, She Did It Publicly In High School And While Drunk </a> 
                            </li>
                                                    <li>
                                <a href="http://thelegendofrandom.com/blog/archives/2961">And The Most Posts Submitted In A Single Sitting Goes To… </a> 
                            </li>
                        			
                    </ul>
                    

                            </div>
            
            <div class="col2">
                      
                    <h3>Archives</h3>
                    <ul>
                        	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/10" title="October 2012">October 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/09" title="September 2012">September 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/08" title="August 2012">August 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/07" title="July 2012">July 2012</a> </li>
	<li><a href="http://thelegendofrandom.com/blog/archives/date/2012/06" title="June 2012">June 2012</a> </li>
                    </ul>

                            </div>
            
            <div class="col3">
                                    <h3>Tags</h3>
                    <ul>
                    	<a href="http://thelegendofrandom.com/blog/archives/tag/adding-functionality" class="tag-link-29" title="1 topic" style="font-size: 8pt;">adding functionality</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/assembly-language" class="tag-link-18" title="1 topic" style="font-size: 8pt;">assembly language</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/binary" class="tag-link-26" title="1 topic" style="font-size: 8pt;">binary</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/code-cave" class="tag-link-27" title="1 topic" style="font-size: 8pt;">code cave</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/code-caves" class="tag-link-30" title="1 topic" style="font-size: 8pt;">code caves</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/cracking" class="tag-link-8" title="5 topics" style="font-size: 16pt;">cracking</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/crackme" class="tag-link-17" title="1 topic" style="font-size: 8pt;">crackme</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/ebook" class="tag-link-19" title="1 topic" style="font-size: 8pt;">ebook</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/exploting-binaries" class="tag-link-28" title="1 topic" style="font-size: 8pt;">exploting binaries</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/guide" class="tag-link-15" title="1 topic" style="font-size: 8pt;">Guide</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/olly" class="tag-link-14" title="2 topics" style="font-size: 11pt;">Olly</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/ollydbg" class="tag-link-10" title="4 topics" style="font-size: 14.666666666667pt;">ollydbg</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/olly-tutorial" class="tag-link-9" title="1 topic" style="font-size: 8pt;">olly tutorial</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/plugins" class="tag-link-11" title="1 topic" style="font-size: 8pt;">plugins</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/reverse-engineering-2" class="tag-link-7" title="3 topics" style="font-size: 13pt;">reverse engineering</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/sandbox" class="tag-link-13" title="1 topic" style="font-size: 8pt;">sandbox</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/tools" class="tag-link-4" title="1 topic" style="font-size: 8pt;">Tools</a> 
<a href="http://thelegendofrandom.com/blog/archives/tag/tutorial" class="tag-link-16" title="2 topics" style="font-size: 11pt;">tutorial</a>                     </ul>
                    
                            </div>
            <div class="clr"></div>
        

            <div class="clr"></div>
        </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>
</div>
<!-- Bottom Panel ends -->


	
    <div class="copyr">Copyright © 1996-2010 The Legend Of Random. All rights reserved.</div>    
    <div class="clr16"></div>
	</div>
    <div id="layoutbottom"></div>
</div>

<div id="credit" align="center">
	<abbr title="Jarrah/1.7">Jarrah</abbr> theme by <a href="http://www.templatesnext.org/">Templates Next</a>  
    | Powered by <a href="http://wordpress.org/">WordPress</a>  
</div>

<script type="text/javascript">
/* <![CDATA[ */
var SlimStatParams = {"ajaxurl":"http:\/\/thelegendofrandom.com\/blog\/wp-admin\/admin-ajax.php","ci":"YTo0OntzOjEyOiJjb250ZW50X3R5cGUiO3M6NDoicG9zdCI7czo4OiJjYXRlZ29yeSI7czo3OiIyNCwzMiw1IjtzOjEwOiJjb250ZW50X2lkIjtpOjE3ODU7czo2OiJhdXRob3IiO3M6NjoiUmFuZG9tIjt9.554dd6cf238ff3b40f299526eb41162c"};
/* ]]> */
</script>
<script type="text/javascript" src="1785_fichiers/wp-slimstat.js"></script><canvas style="display: none;" height="35" width="35"></canvas>


</body></html>