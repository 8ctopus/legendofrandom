<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">


<!-- Mirrored from thelegendofrandom.com/blog/archives/category/tutorials by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 19 Sep 2013 09:33:28 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"  />
<title>Tutorials &laquo;  The Legend Of Random</title>
<meta name="generator" content="WordPress 3.5.1" />
<meta name="robots" content="follow, all" />

<link rel="shortcut icon" href="../../wp-content/themes/jarrah/favicon.ico" />
<link rel="stylesheet" href="../../wp-content/themes/jarrah/style.css" type="text/css" media="screen" />
<link rel="alternate" type="application/rss+xml" title="The Legend Of Random RSS Feed" href="../../feed" />
<link rel="pingback" href="../../xmlrpc.php" />
<link rel="stylesheet" href="../../wp-content/themes/jarrah/css/menu.css" type="text/css" media="screen" />
<!--[if IE]><link rel="stylesheet" href="http://thelegendofrandom.com/blog/wp-content/themes/jarrah/css/ie.css" type="text/css" media="screen" /><![endif]-->

<link rel="alternate" type="application/rss+xml" title="The Legend Of Random &raquo; Tutorials Category Feed" href="tutorials/feed" />
<script type='text/javascript' src='../../wp-includes/js/jquery/jquery4511.js?ver=1.8.3'></script>
<script type='text/javascript' src='../../wp-content/plugins/ajax-quick-subscribe/ajax9d52.js?ver=3.5.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 3.5.1" />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />

<script type="text/javascript" src="../../wp-content/themes/jarrah/js/jquery.pngFix.js"></script>
<script type="text/javascript" src="../../wp-content/themes/jarrah/js/jquery.easing.min.js"></script>
<script type="text/javascript" src="../../wp-content/themes/jarrah/js/jquery.lavalamp.min.js"></script>
<script type="text/javascript" src="../../wp-content/themes/jarrah/js/my-menu.js"></script>

<!-- this product is released under General Public License. Please see the attached file for details. You can also find details about the license at http://www.opensource.org/licenses/gpl-license.php -->
<script type="text/javascript">
/* <![CDATA[ */

jQuery(document).ready(function(){ 
    jQuery(document).pngFix(); 
});

/* ]]> */ 
</script>

</head>

<body>

<div id="wrapper" align="center">
	<div id="layouttop"></div>
    
    <!-- Header Starts -->
    <div id="header">
    	<div id="headerleft">
        	              	<h1><a href="../../index.html">The Legend Of Random</a> </h1><h3>Programming and Reverse Engineering</h3>
			      	   
        </div>
        <div id="headerright">
        	<div id="searchboxo">
        		<form method="get" id="searchform" action="http://thelegendofrandom.com/blog/">
    <input type="text" value="Search keywords" name="s" id="searchbox" onfocus="this.value=''" class="searchinput"/>
    <input type="submit" class="submitbutton" value="" />
</form> 
            </div>
        </div>
    </div>
    <!-- Header Ends -->

    
    
    <div id="innerwrapper">
    	
        <!-- Main nav Starts here -->
        <div id="navouter">
            <div id="nav">

                <ul class="lavalamp" id="menu1">
                <li class="page_item "><a href="../../index.html">Home</a> </li>
                <li class="page_item page-item-2"><a href="../../sample-page.html">Tutorials</a> </li>
<li class="page_item page-item-27"><a href="../../tools.html">Tools</a> </li>
<li class="page_item page-item-153"><a href="../../contact-2.html">Contact</a> </li>
<li class="page_item page-item-846"><a href="http://www.thelegendofrandom.com/forum/">Forum</a> </li>
<li class="page_item page-item-1790"><a href="../../challenges.html">Challenges</a> </li>
			
                </ul>
            
            </div>
        </div>
        <!-- Main nav Ends -->
<!-- main column Starts here -->
<div id="maincol">


	
		<h2 class="arpageTitle">Tutorials</h2>
	

<div class="postwrap">
  <h2 class="posttitle"><a href="../1785">DLL Injection – A Splash Bitmap</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Oct.02, 2012, under <a href="intermediate.html" title="View all posts in Intermediate" rel="category tag">Intermediate</a> , <a href="modifying-binaries.html" title="View all posts in Modifying Binaries" rel="category tag">Modifying Binaries</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>There are a couple ways of injecting a splash screen into a binary. Unfortunately, none of them easy. The way I will show in this tutorial is the easiest I&#8217;ve come across, though there may be simpler options out there. The problem arises from the fact that a bitmap is a resource, and as such, goes in the resources section of a binary. Injecting resources into a compiled binary&#8217;s resource section is a recipe for a quick headache.</p>
<p>The method we&#8217;ll be using is to create a DLL file with the resource included in it, and then call this DLL from our target binary. Because it&#8217;s a DLL, we can load it automatically by changing very little in the binary, as we can just add it to the list of DLLs the binary requires. This also gives us the benefit of running the code in our DLL automatically instead of having to create a code cave.</p>
<p style="text-align: left;">In this tutorial we will be creating a DLL from scratch using assembly, so you will need an assembly language compiler. I use <a href="http://www.oby.ro/rad_asm/"><span style="text-decoration: underline; color: #0a77e1;">RadASM</span></a>  (and it will be more convenient if you use this IDE as well as your code will exactly match mine), but it is not a requirement. If you are not comfortable using RadASM and want to learn, please see my series of tutorials on RadASM on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline; color: #0a77e1;">tutorials</span></a>  page, which comes with a full download of the RadASM suite and everything you need to run it.</p>
<p style="text-align: left;">As with all of my tutorials, the required files for this tutorial are in the downloads, available on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a>  page. In addition to these files, we will be using IIDKing, available on the <a title="Tools" href="../../tools.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tools</span></span></a>  page.</p>
<p style="text-align: left;">If you haven&#8217;t already read my previous <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a>  on modifying binaries, I highly recommend you do (at least the <a href="../1656"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorial</span></span></a>  on injecting a message box).</p>
<p style="text-align: left;"> <a href="../1785#more-1785" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../1785#comments" title="Comment on DLL Injection – A Splash Bitmap">3 Comments</a> </span>
              	<span class="postmore"><a href="../1785">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2592">R4ndom’s Guide to RadASM: Adding an Icon and Menu</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.27, 2012, under <a href="beginner.html" title="View all posts in Beginner" rel="category tag">Beginner</a> , <a href="tools.html" title="View all posts in Tools" rel="category tag">Tools</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><h2><span style="color: #0a77e1;">Adding an Icon</span></h2>
<p>Let&#8217;s start by adding an icon. Load up our HelloWorld project from the last tutorial. Click on Project-&gt;Resources. This will bring up the Resources window:</p>
<p> <a href="../2592#more-2592" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2592#comments" title="Comment on R4ndom’s Guide to RadASM: Adding an Icon and Menu">5 Comments</a> </span>
              	<span class="postmore"><a href="../2592">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2418">R4ndom’s Tutorial #23: TLS Callbacks</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.27, 2012, under <a href="intermediate.html" title="View all posts in Intermediate" rel="category tag">Intermediate</a> , <a href="reverse-engineering.html" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>Unfortunately, our lives as reverse engineers is not always easy. If all it took to patch an app was a deleted resource or a quick patch, a lot more people would do it. Sometimes we must get a little &#8216;low-level&#8217;, wallow around in the operating system files, single-step an exception handler, or reverse engineer an unknown packer. To have a well-rounded skill set as a cracker, we must know a lot about a lot (or at least where to look about a lot) and it can get pretty technical.</p>
<p>This tutorial is about one of those technical areas: TLS callbacks. It is not easy, nor is it simple, but it can ruin an otherwise nice day of a reverse engineer that doesn&#8217;t at least understand the basics of what they are, when they are used, and how to overcome them.</p>
<p>As in all tutorials on my site, the required files are included in the download of this tutorial on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a>  page. We will be looking at three binaries, all  included. We will also be using an Olly plugin called TLSCatch by Walliedassar, also included. Lastly, we will be using CFF Explorer, available on the <a title="Tools" href="../../tools.html"><span style="text-decoration: underline; color: #0a77e1;">tools</span></a>  page.</p>
<p> <a href="../2418#more-2418" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2418#comments" title="Comment on R4ndom’s Tutorial #23: TLS Callbacks">26 Comments</a> </span>
              	<span class="postmore"><a href="../2418">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2517">R4ndom’s Guide to RadASM: Creating Our First Project</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.24, 2012, under <a href="beginner.html" title="View all posts in Beginner" rel="category tag">Beginner</a> , <a href="tools.html" title="View all posts in Tools" rel="category tag">Tools</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>We continue our tutorials on RadASM by creating a new project that creates a dialog box with two bitmaps and two buttons. You can download the required files in the download of this tutorial on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a>  page.</p>
<p> <a href="../2517#more-2517" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2517#comments" title="Comment on R4ndom’s Guide to RadASM: Creating Our First Project">4 Comments</a> </span>
              	<span class="postmore"><a href="../2517">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2420.html">R4ndom’s Guide to RadASM: Installing and Set Up</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.21, 2012, under <a href="beginner.html" title="View all posts in Beginner" rel="category tag">Beginner</a> , <a href="reverse-engineering.html" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>RadASM is a very good IDE (Integrated Development Environment: think Visual Studio) for developing in most programming languages, though assembly language is where it shines. Not only is it one of the few IDEs out there that will work with assembly language, but the author has also put a significant amount of time and effort into it, making it extremely feature rich and robust. Many people use inline assembly in Visual Studio (using __Asm directives) but you really can&#8217;t get the level of control in these big-name IDEs as you can in this product. I used WinASM, a very good product, for years, but when I finally tried RadASM, it felt like someone had created it that really knew assembly language, and the hardships that can bring.</p>
<p>In this series of tutorials I will go over installing RadASM, running it, and creating programs in it, as well as some additional plugins and features. In the download for this tutorial (available on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline; color: #0a77e1;">tutorials</span></a>  page) I have included all of the installation files for RadASM, as well as the Masm SDK, providing everything you need to program in assembly language. So let&#8217;s get started.</p>
<p>Please keep in mind that this is not an assembly language nor a Windows programming tutorial. It is assumed that both of these have already been learned. If you are rusty (or a beginner) I highly recommend the Windows assembly tutorials by Iczelion. Fortunately, they are also based on RadASM, so the transition should be very easy.</p>
<p>http://www.woodmann.com/RCE-CD-SITES/Iczelion/index.html</p>
<p> <a href="../2420.html#more-2420" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2420.html#comments" title="Comment on R4ndom’s Guide to RadASM: Installing and Set Up">9 Comments</a> </span>
              	<span class="postmore"><a href="../2420.html">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2390">R4ndom&#8217;s Tutorial #22: Code Caves and PE Sections</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.20, 2012, under <a href="intermediate.html" title="View all posts in Intermediate" rel="category tag">Intermediate</a> , <a href="reverse-engineering.html" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>In this tutorial we will be talking about code caves as well as PE sections, and touching on the PE header. We will be adding code caves to two crackmes, both available in the download of this tutorial. We will also be using the Multimate Assembler plugin which is also available in the download, as well as LordPE and CFF Explorer which are available on the <span style="text-decoration: underline;"><span style="color: #0a77e1;"><a title="Tools" href="../../tools.html"><span style="color: #0a77e1; text-decoration: underline;">tools</span></a> </span></span> page. This tutorial, as well as all of my others, can be downloaded on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline; color: #0a77e1;">tutorials</span></a>  page.</p>
<p> <a href="../2390#more-2390" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2390#comments" title="Comment on R4ndom&#8217;s Tutorial #22: Code Caves and PE Sections">9 Comments</a> </span>
              	<span class="postmore"><a href="../2390">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2100">R4ndom&#8217;s Tutorial #21: Anti-Debugging Techniques</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.14, 2012, under <a href="beginner.html" title="View all posts in Beginner" rel="category tag">Beginner</a> , <a href="reverse-engineering.html" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>Nowadays, with the plethora of anti-anti-debugging plugins for Olly, you don&#8217;t need to know nearly as much as you used to about anti-debugging techniques. But the problem is, without understanding how they work, when we are confronted with a new technique we find that we have no idea how to overcome it. Additionally, learning about anti-debugging techniques helps us understand low-level protections, and is a good introduction to packers.</p>
<p>Anti-debugging is a rather large field, and impossible to cover in one tutorial. I do hope to shed some light on the most used techniques, as well as direct you to getting additional information on some of the more obscure. I have uploaded several documents to the texts section of the <a title="Tools" href="../../tools.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tools</span></span></a>  page, as well as descriptions of these at the end of this tutorial, which will have a lot more detail on these and other techniques.</p>
<p>In this tutorial, we will be going over a crackme from hell that I wrote specifically for this tutorial. It shows several methods of anti-debugging. It is a very challenging crackme, and as such, this tutorial will be somewhat long and detailed. We will be comparing the source code (in assembly) along side the compiled code in Olly, so dust off that ASM book. As always, you can download all of the accompanying files from the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a>  page.</p>
<p>In order to make this tutorial a little less painful, I have included a picture of the entire source code, a picture of the entire disassembly (in Olly) with comments, and the assembly project for RadASM with source code, all available in the download of this tut. This way you can refer to the source and disassembly while you progress. I have also included an Olly UDD file with the disassembly fully commented. If you wish to see the crackme fully commented in Olly, just copy this file into the UDD folder in Olly, open it in a text editor, and change the file path at the top to match the path to the crackme.</p>
<p>My suggestion, if you would like to get the most from this tutorial, is to use a clean version of Olly with only my .ini file, meaning no plugins. Many of these techniques will still work with plugins, but this way you can see how they work without any intervention. It will also teach you about what a lot of the options in the various anti-debugging plugins are for. I will personally be using a clean install of Olly to show each technique.</p>
<h2> <a href="../2100#more-2100" class="more-link">(continue reading&#8230;)</a> </h2>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2100#comments" title="Comment on R4ndom&#8217;s Tutorial #21: Anti-Debugging Techniques">26 Comments</a> </span>
              	<span class="postmore"><a href="../2100">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2322.html">Detailed View of the IAT</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.12, 2012, under <a href="beginner.html" title="View all posts in Beginner" rel="category tag">Beginner</a> , <a href="randoms-ramblings.html" title="View all posts in Random&#039;s Ramblings" rel="category tag">Random's Ramblings</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>The <span style="color: #00ccff;">IAT</span>, or Important Address Table, is a collection of just that; important addresses. These can include the address of the White House, the address of that hot little number in accounting, or the address of your grandmother. The last address speaks to the fact that these address are obviously relative; you may think that the girl from accounting is hot, but I may think she needs some serious plastic surgery, but that&#8217;s all beside the point. All of this is why we have <span style="color: #00ccff;">RVA</span>s, which tells us exactly how relative these addresses are in importance.</p>
<p><span style="color: #00ccff;">RVA</span> stands for Relative&#8217;s Virtual Address, for example, your grandmothers Facebook address or your mother&#8217;s LinkedIn address- basically any &#8216;virtual&#8217; address of one of your relatives.</p>
<p>Inside the <span style="color: #00ccff;">IAT</span> are various entities called <span style="color: #00ccff;">IMPORT_DESCRIPTOR</span>s. You can tell that these are very important as they are always written in UPPERCASE LETTERS. <span style="color: #00ccff;">IMPORT_DESCRIPTOR</span>s describe imports, like iPhone rip-offs from Korea, Hello Kitty backpacks from Japan, and those cool blankets from Mexico (they&#8217;re kind of scratchy but boy are they warm!)</p>
<p>Here are the various fields in an <span style="color: #00ccff;">IMPORT_DESCRIPTOR</span>, along with descriptions of each one:</p>
<p><span style="color: #ff9900;"><strong>OriginalFirstThunk:</strong></span></p>
<p>&#8220;Thunk&#8221;, in this case, is like &#8220;I thunk I knew how many bytes there were in the <span style="color: #00ccff;">IAT</span>, but I guess I was wrong&#8221; or &#8220;You probably thunk that there were 16 bytes in an <span style="color: #00ccff;">IMPORT_DESCRIPTOR</span>, but there are actually 20.&#8221; The original first thunk is obviously the first thunk in history, probably &#8220;Who am I?&#8221; or &#8220;Why am I here?&#8221;.</p>
<p><strong><span style="color: #ff9900;">TimeDateStamp:</span></strong></p>
<p>Time is the current date, in stamp form.</p>
<p><span style="color: #ff9900;"><strong>ForwarderChain</strong></span></p>
<p>This is similar to those old chain letters, where everyone sends $1 to the first person on the list of 10 people, and eventually everyone would be rich. But this field is the digital equivalent of that.</p>
<p><strong><span style="color: #ff9900;">Name:</span></strong></p>
<p>In case you cant thunk of the name of this field, the name is conveniently written here.</p>
<p><strong><span style="color: #ff9900;">FirstThunk:</span></strong></p>
<p>This is the first thunk of the day, as opposed to the original first thunk, which is the first thunk in history. This also points to a <span style="color: #00ccff;">hint</span>, just in case you forgot the name and can&#8217;t thunk of it.</p>
<p>Each one of these entries is devoted to a specific <span style="color: #00ccff;">DLL</span>, or Distributed List of Lies. <span style="color: #00ccff;">DLL</span>s add functionality to a program, like an amazing haircut, incredibly fast weight loss, or the ability to read the screen with your eyes closed. Though, as the name would suggest, they really can&#8217;t be trusted, so you do probably look fat in that dress.</p>
<p>All of these entities are inside the <span style="color: #00ccff;">PE file</span> (PE stands for Poorly Executed), as opposed to a <span style="color: #00ccff;">COFF</span> file (and sister files BURP, SNEEZE and HICCUP). There are other items inside these files, like voodoo <span style="color: #00ccff;">Magic</span> (which for some reason is spelled MZ), the <span style="color: #00ccff;">Address of Entry Point</span> (in case you need additional help with that sexy number in accounting), and the <span style="color: #00ccff;">.bss</span> section, where you put jokes, funny sayings and other BS.</p>
<p>Lastly, of course, all of this is put into <span style="color: #00ccff;">memory</span>, which doesn&#8217;t explain why you need so many <span style="color: #00ccff;">hint</span>s and fields with the name and so forth. I guess with all of these acronyms, thunking of the right one when you need it is probably a daunting task!</p>
<p>I hope this helped in understanding the <span style="color: #00ccff;">IAT</span>. Please stay tuned for my next tutorial on &#8220;Break-points&#8221; (mine is waiting more than an hour in the dentists office).</p>
<p>-Till next time</p>
<p>R4ndumb.</p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2322.html#comments" title="Comment on Detailed View of the IAT">5 Comments</a> </span>
              	<span class="postmore"><a href="../2322.html">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2231">Shrinking C++ Executables</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.10, 2012, under <a href="intermediate.html" title="View all posts in Intermediate" rel="category tag">Intermediate</a> , <a href="modifying-binaries.html" title="View all posts in Modifying Binaries" rel="category tag">Modifying Binaries</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>Over the course of creating these tutorials, I have been confronted with attempting to make the compiled binaries small. Usually, after entering a three line program in C++, Visual Studio will assume I would like every DLL, API and function ever created by Microsoft to be included in my binary, and I end up having something close to a 6 meg file. (Don&#8217;t even get me started on the fact that you can open a new Word document, type one letter, and the file no longer fits on a 32Gig USB key!)</p>
<p>Because you don&#8217;t want the binary filled with a bunch of useless crap to detract from the learning process, the binary should ONLY contain the instructions you want used, and nothing else. You would think this would be easy- perhaps a button somewhere that says &#8220;De-crapify&#8221; or something, but this is Microsoft, so you actually have to do quite a bit of experimenting in Visual Studio to get the binary size even close to what it should actually be.</p>
<p>Over the weekend I did some experimenting, attempting to get the binary as small as possible and trying to figure out what all this crap is that gets inserted into our binary, and this tutorial covers what I learned. A lot of this info was performed by <a href="http://forum.tuts4you.com/topic/29934-reduce-your-c-executable-size/"><span style="text-decoration: underline; color: #0a77e1;">Zer0Flag</span></a> , so many thanks (and kudos) go out to him for his hard work. If you would rather have the PDF of this tutorial, you can download it on the <span style="color: #0a77e1;"><a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline; color: #0a77e1;">tutorials</span></a> </span> page. Otherwise, read on&#8230;</p>
<p> <a href="../2231#more-2231" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2231#comments" title="Comment on Shrinking C++ Executables">16 Comments</a> </span>
              	<span class="postmore"><a href="../2231">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>


<div class="postwrap">
  <h2 class="posttitle"><a href="../2044">R4ndom&#8217;s Tutorial #20B: Working With Visual Basic Binaries, Pt 2</a> </h2>
  <div class="postmeta">by <a href="../author/random.html" title="Posts by R4ndom" rel="author">R4ndom</a>  on Sep.07, 2012, under <a href="beginner.html" title="View all posts in Beginner" rel="category tag">Beginner</a> , <a href="reverse-engineering.html" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a> , <a href="tutorials.html" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
  <div class="clr16"></div>
  <div class="postcontent"><p>This is part 2 of Working with Visual Basic Binaries. In this tutorial we will be using VB Decompiler which is available in the download from part 1 of this tutorial. We will also be using MapConvert and OllyVBHelper- plugins for Olly, P32Dasm and some additional crackmes, all of which are available in the download of this tutorial on the <a title="Tutorials" href="../../sample-page.html"><span style="text-decoration: underline; color: #0a77e1;">tutorials</span></a>  page.<br />
 <a href="../2044#more-2044" class="more-link">(continue reading&#8230;)</a> </p>
</div>
  <div class="clr"></div>
    
	<div class="roundcornrrbox">
		<div class="topleftcorner"><div class="toprightcorner"></div></div>
			<div class="roubcornrcontent">
            	
                <span class="posttags">No tags</span>  
              	<span class="postcomments"><a href="../2044#comments" title="Comment on R4ndom&#8217;s Tutorial #20B: Working With Visual Basic Binaries, Pt 2">17 Comments</a> </span>
              	<span class="postmore"><a href="../2044">more...</a> </span>
                <div class="clr"></div>
            </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>

<div class="cleared"></div>
</div> <!-- Closes topPost --><br/>



<div id="nextprevious">
<div class="alignleft"><a href="tutorials/page/2.html" >&laquo; Older Entries</a> </div>
<div class="alignright"></div>
<div class="cleared"></div>
</div>
</div>


<!-- right column Starts here -->
<div id="rightcol">
	<div class="roundcornrrbox">
    <div class="topleftcorner"><div class="toprightcorner"></div></div>
    <div class="roundcrrcnt">
        <!-- Optional Intro -->
                
        <!-- widget -->



<h2>Login</h2>
<form action="http://thelegendofrandom.com/blog/wp-login.php" method="post">
<input type="text" name="log" id="log" value="" size="20" />
<input type="password" name="pwd" id="pwd" size="20" />
<input type="submit" name="submit" value="Send" class="button" />
    <p>
       <label for="rememberme"><input name="rememberme" id="rememberme" type="checkbox" checked="checked" value="forever" /> Remember me</label>
       <input type="hidden" name="redirect_to" value="/blog/archives/category/tutorials" />
    </p>
</form>
<a href="../../wp-loginc2b6.html?action=lostpassword">Recover password</a> 



        		<li id="recent-posts-2" class="sidebaritem widget_recent_entries"><div class="sidebarbox">		<h2 class="widgettitle">Recent Posts</h2>		<ul>
					<li>
				<a href="../2980.html" title="My Absence">My Absence</a> 
						</li>
					<li>
				<a href="../2975.html" title="What Are These Strange Posts?">What Are These Strange Posts?</a> 
						</li>
					<li>
				<a href="../2966.html" title="Nice Beginning Article on Reversing Android">Nice Beginning Article on Reversing Android</a> 
						</li>
					<li>
				<a href="../2963.html" title="She Is 17-years-old, She Did It Publicly In High School And While Drunk">She Is 17-years-old, She Did It Publicly In High School And While Drunk</a> 
						</li>
					<li>
				<a href="../2961.html" title="And The Most Posts Submitted In A Single Sitting Goes To&#8230;">And The Most Posts Submitted In A Single Sitting Goes To&#8230;</a> 
						</li>
				</ul>
		</div></li><li id="recent-comments-2" class="sidebaritem widget_recent_comments"><div class="sidebarbox"><h2 class="widgettitle">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments"><a href='http://www.economicscafe.com.sg/' rel='external nofollow' class='url'>jc economics tuition</a>  on <a href="../258.html#comment-85252">Tutorial #4: Using Olly, Part 2</a> </li><li class="recentcomments">Ray on <a href="../654.html#comment-85087">R4ndom&#8217;s Tutorial #9: No Strings Attached</a> </li><li class="recentcomments">equal on <a href="../506.html#comment-84987">Tutorial #8: Frame Of Reference</a> </li><li class="recentcomments">Deeren on <a href="../2420.html#comment-84709">R4ndom’s Guide to RadASM: Installing and Set Up</a> </li><li class="recentcomments">Abutharik on <a href="../833.html#comment-84487">R4ndom&#8217;s Tutorial #10: The Levels Of Patching</a> </li></ul></div></li><li id="archives-2" class="sidebaritem widget_archive"><div class="sidebarbox"><h2 class="widgettitle">Archives</h2>		<ul>
			<li><a href='../date/2012/10.html' title='October 2012'>October 2012</a> </li>
	<li><a href='../date/2012/09.html' title='September 2012'>September 2012</a> </li>
	<li><a href='../date/2012/08.html' title='August 2012'>August 2012</a> </li>
	<li><a href='../date/2012/07.html' title='July 2012'>July 2012</a> </li>
	<li><a href='../date/2012/06.html' title='June 2012'>June 2012</a> </li>
	<li><a href='../date/2012/05.html' title='May 2012'>May 2012</a> </li>
		</ul>
</div></li><li id="categories-2" class="sidebaritem widget_categories"><div class="sidebarbox"><h2 class="widgettitle">Categories</h2>		<ul>
	<li class="cat-item cat-item-23"><a href="beginner.html" title="View all posts filed under Beginner">Beginner</a> 
</li>
	<li class="cat-item cat-item-31"><a href="challenges.html" title="View all posts filed under Challenges">Challenges</a> 
</li>
	<li class="cat-item cat-item-24"><a href="intermediate.html" title="View all posts filed under Intermediate">Intermediate</a> 
</li>
	<li class="cat-item cat-item-32"><a href="modifying-binaries.html" title="View all posts filed under Modifying Binaries">Modifying Binaries</a> 
</li>
	<li class="cat-item cat-item-25"><a href="randoms-ramblings.html" title="View all posts filed under Random&#039;s Ramblings">Random&#039;s Ramblings</a> 
</li>
	<li class="cat-item cat-item-3"><a href="reverse-engineering.html" title="View all posts filed under Reverse Engineering">Reverse Engineering</a> 
</li>
	<li class="cat-item cat-item-4"><a href="tools.html" title="View all posts filed under Tools">Tools</a> 
</li>
	<li class="cat-item cat-item-5 current-cat"><a href="tutorials.html" title="View all posts filed under Tutorials">Tutorials</a> 
</li>
	<li class="cat-item cat-item-1"><a href="uncategorized.html" title="View all posts filed under Uncategorized">Uncategorized</a> 
</li>
		</ul>
</div></li><li id="meta-2" class="sidebaritem widget_meta"><div class="sidebarbox"><h2 class="widgettitle">Meta</h2>			<ul>
			<li><a href="../../wp-login0ddc.html?action=register">Register</a> </li>			<li><a href="../../wp-login.html">Log in</a> </li>
			<li><a href="../../feed" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a> </li>
			<li><a href="../../comments/feed" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a> </li>
			<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a> </li>
						</ul>
</div></li><li id="ajax-quick-subscribe" class="sidebaritem widget_quick_subscribe"><div class="sidebarbox"><h2 class="widgettitle">Subscribe</h2>Enter your email to subscribe to future updates<div id="QSWidgetDiv" class="QSWidgetDiv"><form name='widget_quick_subscribe_form' id='widget_quick_subscribe_form'><input type='email' name='QS_user_email_widget' id='QS_user_email_widget' placeholder='email@email.com' onFocus='fadeSubmitIn("widget_qsSubmit");' onBlur='fadeSubmitOut(this, "widget_qsSubmit");'  onkeypress='return checkForEnter(event, "QS_user_email_widget", "QSWidgetDiv"); return false;'><input style='display:none;' type='button' value='subscribe!' id='widget_qsSubmit' class='widget_qsSubmit' onClick='submitQuickSubscribe("QS_user_email_widget", "QSWidgetDiv");'></form></div>			
			</div></li> 

        <div class="clr"></div>

    	<div id="feedbox">
            <div id="contrssbox">
                <a href="../../feed">RSS Feed</a> 
            </div>
        </div>
        


    </div>
    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
</div>
</div>
<div class="clr"></div>

    
	<div id="bottompanel">
    <div class="roundcornrrbox">
        <div class="topleftcorner"><div class="toprightcorner"></div></div>
        <div class="roundcrrcnt">
        
        	
            <div class="col1">
                
					                    <h3>Recent Posts</h3>
                    <ul>
                                                    <li>
                                <a href="../2980.html">My Absence </a> 
                            </li>
                                                    <li>
                                <a href="../2975.html">What Are These Strange Posts? </a> 
                            </li>
                                                    <li>
                                <a href="../2966.html">Nice Beginning Article on Reversing Android </a> 
                            </li>
                                                    <li>
                                <a href="../2963.html">She Is 17-years-old, She Did It Publicly In High School And While Drunk </a> 
                            </li>
                                                    <li>
                                <a href="../2961.html">And The Most Posts Submitted In A Single Sitting Goes To&#8230; </a> 
                            </li>
                        			
                    </ul>
                    

                            </div>
            
            <div class="col2">
                      
                    <h3>Archives</h3>
                    <ul>
                        	<li><a href='../date/2012/10.html' title='October 2012'>October 2012</a> </li>
	<li><a href='../date/2012/09.html' title='September 2012'>September 2012</a> </li>
	<li><a href='../date/2012/08.html' title='August 2012'>August 2012</a> </li>
	<li><a href='../date/2012/07.html' title='July 2012'>July 2012</a> </li>
	<li><a href='../date/2012/06.html' title='June 2012'>June 2012</a> </li>
                    </ul>

                            </div>
            
            <div class="col3">
                                    <h3>Tags</h3>
                    <ul>
                    	<a href='../tag/adding-functionality.html' class='tag-link-29' title='1 topic' style='font-size: 8pt;'>adding functionality</a> 
<a href='../tag/assembly-language.html' class='tag-link-18' title='1 topic' style='font-size: 8pt;'>assembly language</a> 
<a href='../tag/binary.html' class='tag-link-26' title='1 topic' style='font-size: 8pt;'>binary</a> 
<a href='../tag/code-cave.html' class='tag-link-27' title='1 topic' style='font-size: 8pt;'>code cave</a> 
<a href='../tag/code-caves.html' class='tag-link-30' title='1 topic' style='font-size: 8pt;'>code caves</a> 
<a href='../tag/cracking.html' class='tag-link-8' title='5 topics' style='font-size: 16pt;'>cracking</a> 
<a href='../tag/crackme.html' class='tag-link-17' title='1 topic' style='font-size: 8pt;'>crackme</a> 
<a href='../tag/ebook.html' class='tag-link-19' title='1 topic' style='font-size: 8pt;'>ebook</a> 
<a href='../tag/exploting-binaries.html' class='tag-link-28' title='1 topic' style='font-size: 8pt;'>exploting binaries</a> 
<a href='../tag/guide.html' class='tag-link-15' title='1 topic' style='font-size: 8pt;'>Guide</a> 
<a href='../tag/olly.html' class='tag-link-14' title='2 topics' style='font-size: 11pt;'>Olly</a> 
<a href='../tag/ollydbg.html' class='tag-link-10' title='4 topics' style='font-size: 14.666666666667pt;'>ollydbg</a> 
<a href='../tag/olly-tutorial.html' class='tag-link-9' title='1 topic' style='font-size: 8pt;'>olly tutorial</a> 
<a href='../tag/plugins.html' class='tag-link-11' title='1 topic' style='font-size: 8pt;'>plugins</a> 
<a href='../tag/reverse-engineering-2.html' class='tag-link-7' title='3 topics' style='font-size: 13pt;'>reverse engineering</a> 
<a href='../tag/sandbox.html' class='tag-link-13' title='1 topic' style='font-size: 8pt;'>sandbox</a> 
<a href='../tag/tools.html' class='tag-link-4' title='1 topic' style='font-size: 8pt;'>Tools</a> 
<a href='../tag/tutorial.html' class='tag-link-16' title='2 topics' style='font-size: 11pt;'>tutorial</a>                     </ul>
                    
                            </div>
            <div class="clr"></div>
        

            <div class="clr"></div>
        </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>
</div>
<!-- Bottom Panel ends -->


	
    <div class="copyr">Copyright &copy; 1996-2010 The Legend Of Random. All rights reserved.</div>    
    <div class="clr16"></div>
	</div>
    <div id="layoutbottom"></div>
</div>

<div id="credit" align="center">
	<abbr title="Jarrah/1.7">Jarrah</abbr> theme by <a href="http://www.templatesnext.org/">Templates Next</a>  
    | Powered by <a href="http://wordpress.org/">WordPress</a>  
</div>


</body>

<!-- Mirrored from thelegendofrandom.com/blog/archives/category/tutorials by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 19 Sep 2013 09:33:29 GMT -->
</html>