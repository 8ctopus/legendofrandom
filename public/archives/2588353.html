<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">


<!-- Mirrored from thelegendofrandom.com/blog/archives/258?replytocom=2803 by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 19 Sep 2013 11:04:55 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"  />
<title>Tutorial #4: Using Olly, Part 2 &laquo;  The Legend Of Random</title>
<meta name="generator" content="WordPress 3.5.1" />
<meta name="robots" content="follow, all" />

<link rel="shortcut icon" href="../wp-content/themes/jarrah/favicon.ico" />
<link rel="stylesheet" href="../wp-content/themes/jarrah/style.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../wp-content/themes/jarrah/css/menu.css" type="text/css" media="screen" />

<link rel="alternate" type="application/rss+xml" title="The Legend Of Random &raquo; Tutorial #4: Using Olly, Part 2 Comments Feed" href="258/feed" />
<script type='text/javascript' src='../wp-includes/js/jquery/jquery4511.js?ver=1.8.3'></script>
<script type='text/javascript' src='../wp-content/plugins/ajax-quick-subscribe/ajax9d52.js?ver=3.5.1'></script>
<script type='text/javascript' src='../wp-includes/js/comment-reply.min9d52.js?ver=3.5.1'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../xmlrpc0db0.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Tutorials, Now With Flash' href='219.html' />
<link rel='next' title='Tutorial #5: Our First (Sort Of) Crack' href='332.html' />
<meta name="generator" content="WordPress 3.5.1" />
<link rel='canonical' href='258.html' />
<link rel='shortlink' href='../indexb773.html?p=258' />
<meta name='robots' content='noindex,nofollow' />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.3" />

<script type="text/javascript" src="wp-content/themes/jarrah/js/jquery.pngFix.js"></script>
<script type="text/javascript" src="wp-content/themes/jarrah/js/jquery.easing.min.js"></script>
<script type="text/javascript" src="wp-content/themes/jarrah/js/jquery.lavalamp.min.js"></script>
<script type="text/javascript" src="wp-content/themes/jarrah/js/my-menu.js"></script>

<!-- this product is released under General Public License. Please see the attached file for details. You can also find details about the license at http://www.opensource.org/licenses/gpl-license.php -->
<script type="text/javascript">
/* <![CDATA[ */

jQuery(document).ready(function(){ 
    jQuery(document).pngFix(); 
});

/* ]]> */ 
</script>

</head>

<body>

<div id="wrapper" align="center">
	<div id="layouttop"></div>
    
    <!-- Header Starts -->
    <div id="header">
    	<div id="headerleft">
        	              	<h1><a href="http://thelegendofrandom.com/blog">The Legend Of Random</a> </h1><h3>Programming and Reverse Engineering</h3>
			      	   
        </div>
        <div id="headerright">
        	<div id="searchboxo">
        		<form method="get" id="searchform" action="http://thelegendofrandom.com/blog/">
    <input type="text" value="Search keywords" name="s" id="searchbox" onfocus="this.value=''" class="searchinput"/>
    <input type="submit" class="submitbutton" value="" />
</form> 
            </div>
        </div>
    </div>
    <!-- Header Ends -->

    
    
    <div id="innerwrapper">
    	
        <!-- Main nav Starts here -->
        <div id="navouter">
            <div id="nav">

                <ul class="lavalamp" id="menu1">
                <li class="page_item "><a href="http://thelegendofrandom.com/blog">Home</a> </li>
                <li class="page_item page-item-2"><a href="http://thelegendofrandom.com/blog/sample-page">Tutorials</a> </li>
<li class="page_item page-item-27"><a href="http://thelegendofrandom.com/blog/tools">Tools</a> </li>
<li class="page_item page-item-153"><a href="http://thelegendofrandom.com/blog/contact-2">Contact</a> </li>
<li class="page_item page-item-846"><a href="http://www.thelegendofrandom.com/forum/">Forum</a> </li>
<li class="page_item page-item-1790"><a href="http://thelegendofrandom.com/blog/challenges">Challenges</a> </li>
			
                </ul>
            
            </div>
        </div>
        <!-- Main nav Ends -->
<div id="maincol">
		
        <div class="postwrap">
          	<h2 class="posttitle"><a href="archives/258">Tutorial #4: Using Olly, Part 2</a> </h2>
          	<div class="postmeta">by <a href="archives/author/random" title="Posts by R4ndom" rel="author">R4ndom</a>  on Jun.05, 2012, under <a href="archives/category/reverse-engineering" title="View all posts in Reverse Engineering" rel="category tag">Reverse Engineering</a> , <a href="archives/category/tutorials" title="View all posts in Tutorials" rel="category tag">Tutorials</a> </div>
            <div class="clr16"></div>
          	<div class="postcontent"><h2><span style="color: #0a77e1;">Introduction</span></h2>
<p>In this tutorial we are going to continue with learning to use Olly. We will use the same program used in the last tutorial (I will also include it in the downloads of this one again).</p>
<p>You can download the files and PDF version of this tutorial on the <a title="Tutorials" href="http://thelegendofrandom.com/blog/sample-page"><span style="text-decoration: underline;"><span style="color: #0a77e1; text-decoration: underline;">tutorials</span></span></a>  page.</p>
<h2><span style="color: #0a77e1;">DLLs</span></h2>
<p>As I told you in an earlier tutorial, DLLs are loaded by the system loader when you start your app. Let me be more specific this time. DLL (Dynamic Link Libraries) are collections of functions, usually provided by Windows (though they can be provided by anyone) that are used a lot in windows programs. They are also functions that make it easier for programmers to perform what would otherwise be tedious, repetitive tasks. These functions are stored in libraries that are dynamically linked in when needed.</p>
<p>For example, converting a string to all uppercase is something that needs to be done in a lot of applications. You have three choices if your app uses this functionality multiple times in your app; 1) you can code it yourself and put it in your app. The problem is, what if you know that your next app is also going to use this same function many times? You would need to cut and paste it into every app you make that uses it! 2) You can create your own library that any app you make can call. In this case, you would create a DLL that you would include with every app, and this DLL would have convertToUpper, as well as other common functions, that your apps can call, thereby only having to code it once. Another good thing about this is, say you come up with a nice optimization for converting a string to all uppercase. In the first example, you would need to copy this new code to every app that uses it, but in the the case of a common DLL, you would just change the code in the DLL and every app that used that DLL would get the benefit of the faster code. Sweet. This was really the reason DLLs came in to being.</p>
<p><span id="more-258"></span></p>
<p>The last option is to use one of the thousands of functions that Windows has included in it&#8217;s own set of DLLs. There are many benefits to this. The first is that the coders at Microsoft have been spending years optimizing their functions, so chances are they&#8217;re better than yours. Secondly, you do not have to include any of your own DLLs with your app as all windows systems have these DLLs built in. And lastly, if Windows decides to change their operating system, your custom DLLs may not be compatible with the new operating system, while if you use Windows DLLs, they are guaranteed to be compatible.</p>
<h2><span style="color: #0a77e1;">How DLLs Are Used</span></h2>
<p>Now that you know what a DLL is, let&#8217;s talk about how they&#8217;re used. A DLL is basically just a library of functions that your app can call. When you first load your app, the Windows Loader checks a special section of the PE Header (remember the PE Header?) and checks to see what functions your app calls and from what DLL&#8217;s these functions reside in. After loading your app into memory, it then iterates through these DLLs and loads each one into your app&#8217;s memory space. It then goes through all of your app&#8217;s code and injects the correct address of where it put these DLL functions into your program everywhere your program calls that function. For example, if one of your first calls is to convert a buffer of letters to uppercase by calling StrToUpper in the kernel32 DLL (just an example), the loader will find the place it loaded the kernel32 DLL, find the address of the StrToUpper function, and inject that address into the lines of code in your app that call that function. Your app will then call into the kernel32&#8242;s DLL space in memory, perform the StrToUpper function, and then return back to your program.</p>
<p>Let&#8217;s see this in action. Load the FirstProgram.exe program included with this tutorial into Olly. Olly will break at the first line of code (from now on called the Entry Point &#8211; this is important as this is what the PE Header calls it for when we start discussing that in detail.)</p>
<p><a href="wp-content/uploads/2012/06/olly111.png"><img class=" wp-image-260 alignnone" title="Main screen" src="wp-content/uploads/2012/06/olly111.png" alt="Main screen" width="605" height="480" /></a> </p>
<p>If you look at the second line of the code, you will see a call to a function called kernel32.GetModuleHandleA. First off, let&#8217;s see what this function does. In case you did not get it in the last tutorial, I have included in the downloads for this tutorial a file called WIN32.HLP as well as a text document explaining how to install it into Olly. This file allows you to right-click on a Windows API you are unfamiliar with and it will show you what the API does. You may need to restart Olly after you copy it over. Right click on GetModuleHandleA and select &#8220;Help on Symbolic Name&#8221;. Olly will bring up a cheat sheet of this API:</p>
<p style="text-align: center;"><a><img class="aligncenter size-full wp-image-263" title="Help on symbolic names" src="wp-content/uploads/2012/06/olly26.png" alt="Help on symbolic names" width="284" height="440" /></a> <a href="wp-content/uploads/2012/06/olly31.png"><img class="aligncenter  wp-image-264" title="Help window" src="wp-content/uploads/2012/06/olly31.png" alt="Help window" width="446" height="380" /></a> </p>
<p>So, basically, this functions gets a handle to our program&#8217;s memory space. In Windows, if you want to do ANYTHING to a window (or pretty much any other object for that matter) you must get a handle to it. This is basically just a unique identifier so Windows knows which object you&#8217;re referring to. GetModuleHandle is actually a little more complicated than this, but let&#8217;s return when we have more knowledge under our belt.</p>
<p>Close the help window and let&#8217;s see exactly where this call is going. As Olly has tried to help and replaced the actual address of the GetModuleHandleA with the name of the function, let&#8217;s see what address it resides at. Click once on the GetModuleHandleA call line and hit the space bar. That will open up the assembly window:</p>
<p><a href="wp-content/uploads/2012/06/olly41.png"><img class="aligncenter size-full wp-image-266" title="Assembly window" src="wp-content/uploads/2012/06/olly41.png" alt="Assembly window" width="329" height="112" /></a> </p>
<p>This window serves two purposes; it first shows you the exact assembly language instructions that are being computed (in case Olly has helpfully replaced the address) and secondly it allows us to edit the assembly language. We will not be doing any editing until next tutorial, so for this time lets just look at the address: 4012D6.There are two ways to jump to this address (without actually running the code) to see what&#8217;s there. You can highlight the &#8220;CALL GetModuleHandleA&#8221; line and hit &#8220;Enter&#8221;.  You can also hit Ctrl-G and enter the address manually. Let&#8217;s try the first way- select the line at address 401002 (in the third column with the actual instruction in it) and click enter, and you will be taken to the code that that call has called into:</p>
<p><a href="wp-content/uploads/2012/06/olly51.png"><img class="aligncenter size-full wp-image-267" title="Jump Table #1" src="wp-content/uploads/2012/06/olly51.png" alt="Jump Table #1" width="669" height="127" /></a> </p>
<p>Now this is interesting: it sure doesn&#8217;t look like code that would perform GetModuleHandleA. It look more like a series of jumps. There is a very good reason for this, but unfortunately, one that requires a little explanation.</p>
<h2><span style="color: #0a77e1;">The Address Jump Table</span></h2>
<p>The first thing to know is that DLLs do not always get loaded into memory at the same spot. The Windows loader, which is responsible for loading your app and all of the support DLLs that your program needs, is allowed to change where in memory these DLLs can be loaded (and frankly, can even change where your app can be loaded, but we&#8217;ll get to that later). The reason for this is let&#8217;s say a Windows DLL, one of the first ones loaded, is mapped into address 80000000. Well let&#8217;s say you have also included a DLL in your app that wants to be loaded at that same address. Since both DLLs can&#8217;t be loaded at the same address, the loader must move one of these DLLs to another address. This happens all the time, and is called relocation.</p>
<p>Here&#8217;s the problem: When you first coded your application and wrote an instruction that called GetModuleHandleA, the compiler knew exactly where the proper DLL was, so it put an address into that instruction, something like &#8220;CALL 800000000&#8243;. Now, when your program is loaded into memory, it still has this call to 800000000 (I&#8217;m being overly simple here <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> , but what if the loader has decided to move this DLL to 80000E300? Your call will call the wrong function!</p>
<p>The way the PE file, and hence the Windows file,  got around this problem was by creating a jump table. What this means is that when your code was first compiled, every call to GetModuleHandleA pointed to a single location in your app, and this single location immediately jumps to an arbitrary address (which will eventually become the proper address). In fact, all function calls into DLLs use this same technique; they each call a specific address that then immediately jumps to an arbitrary address. When the loader loads in all the DLLs, it goes through this &#8216;jump table&#8217; and replaces all of the arbitrary address with the real address of the functions in the memory. This is what a jump table looks like after all of the real addresses have been populated:</p>
<p><a href="wp-content/uploads/2012/06/olly62.png"><img class="aligncenter size-full wp-image-268" title="Jump Table #2" src="wp-content/uploads/2012/06/olly62.png" alt="Jump Table #2" width="666" height="294" /></a> </p>
<p>Just as this is sort of a complicated idea, let me give you an example. We will write a short program, using completely arbitrary information (just to prove our point) that calls a function in kernel32.dll called ShowMarioBrosPicture. Here is our program (in no specific language):</p>
<pre>main()
{
      call ShowMarioBrosPicture();
      call ShowDoYouLikeDialog()
      exit();
}
ShowDoYouLikeDialog()
{
      If ( user clicks yes )
      {
          call ShowMarioBrosPicture();
          Call ShowMessage( "Yes, it's our favorite too!")
      }
      else
      {
          call showMessage( "You obviously never played Super Mario Bros.");
      }
}</pre>
<p>After compiling this, the calls to functions will be replaced by actual address and will look something like this (again, not in any specific language):</p>
<pre>401000    call 402000     // Call ChowMarioBrosPicture
401002    call 401006     // Call showDoYouLikeDialog
401004    call ExitProcess
401006    Code for "Do You like It" dialog
.
.
.
40109A    if (user clicks yes)
40109C  call 402000    // call showMarioBrosPicture
40109E    call 4010FE    // call show message
4010a1  call ExitProcess
4010a3  if (user clicks no)
4010a5  call 4010FE    // call show message
4010a7  call ExitProcess

4010FE  code for show message
...
40110A  retn</pre>
<p>and down below would be our jump table (in this case, only showMarioBrosPicture is in it)<br />
<strong>402000  JMP XXXXXXXX</strong></p>
<p>Now, since out program has no idea where showMarioBrosPicture is going to be ( or where the kernel32 DLL file is going to be for that matter), the compiler of our program is just going to fill in X&#8217;s for the actual address call (not really but you get the idea).</p>
<p>Now, when the Windows loader loads our app, it first loads our binary into memory, complete with the jump table, but the jump table doesn&#8217;t have any real addresses in it yet. It then starts loading DLLs into our memory space, and finally starts figuring out where all the functions reside. Once it finds the address for showMarioBrosPicture, it is going to go into our jump table and replace the X&#8217;s with the actual address of that function. Let&#8217;s say the showMarioBrosPicture address was at 77CE550A. Our jump table code would then be replaced with:</p>
<p><strong>402000 JMP 77CE550A</strong>.</p>
<p>Now, since Olly can figure out that this is pointing to showMarioBrosPicture, it will helpfully go into our jump table and actually show it as :</p>
<p><strong>402000 JMP DWORD PTR DS:[&lt;&amp;kernel32.showMarioBrosPicture&gt;]</strong></p>
<p>Now, let&#8217;s go back and look at the jump table in our FirstProgram app:</p>
<p><a href="wp-content/uploads/2012/06/olly63.png"><img class="aligncenter size-full wp-image-269" title="Jump Table #2" src="wp-content/uploads/2012/06/olly63.png" alt="Jump Table #2" width="666" height="294" /></a> </p>
<p>When this program was first coded, all of these functions were called in various DLLs, but the compiler did not know where these functions were going to be placed in memory when our program was run, so it would have created something that looked (though not exactly) like this:</p>
<p><strong>40124C    JMP XXXXX</strong>    <span style="color: #00ff00;">// gdi32.DeleteObject</span><br />
<strong>401252    JMP XXXXX</strong>    <span style="color: #00ff00;">// user32.CreateDialogParamA</span><br />
<strong>401258  JMP XXXXX </strong>   <span style="color: #00ff00;">// user32.DefWindowProcA</span><br />
<strong>40125E  JMP XXXXX </strong>   <span style="color: #00ff00;">// user32.DestroyWindow</span><br />
<strong>&#8230;</strong></p>
<p>After the loader loaded our app and then loaded all the DLLs and found the address of these functions, it would have then gone through each one of these and replaced them with the actual address these functions now reside at, namely what you saw in the previous picture. If you think about this, this is a pretty smart way to handle this. If not done this way, the loader would be forced to go through our entire app and replace EVERY call to EVERY function in EVERY DLL and replace that address with the true address. That would be a lot of work. This way, the loader only has to replace the address in one place per function call, namely that functions line in the jump table.</p>
<p>Let&#8217;s See For Ourselves. Reload the app in Olly and hit F7. Click on the instruction in line 401002 (like we did before) and hit the space bar (like we did before):</p>
<p><a href="wp-content/uploads/2012/06/olly42.png"><img class="aligncenter size-full wp-image-270" title="Assembly Window" src="wp-content/uploads/2012/06/olly42.png" alt="Assembly Window" width="329" height="112" /></a> </p>
<p>I just wanted you to notice the address again, 4012D6. Now click F7 to step into the call and you will notice that we will land at address 4012D6, which if you scroll up a little, you will also notice that we have called into the middle of the jump table:</p>
<p><a href="wp-content/uploads/2012/06/olly62.png"><img class="aligncenter size-full wp-image-268" title="Jump Table #2" src="wp-content/uploads/2012/06/olly62.png" alt="Jump Table #2" width="666" height="294" /></a> <br />
Now, click F7 again and we will be taken to the REAL address of GetModuleHandleA at 7780B741. You can tell we are now in module kernel32 in two ways, both of which you will use at different times. The first is the title of Olly&#8217;s CPU window:</p>
<p><a href="wp-content/uploads/2012/06/olly81.png"><img class="aligncenter size-full wp-image-273" title="Olly Title" src="wp-content/uploads/2012/06/olly81.png" alt="Olly Title" width="351" height="150" /></a> </p>
<p>You can see that it says &#8220;module kernel32&#8243;. And the second way you can tell is by going into the memory window and looking up the address:</p>
<p><a href="wp-content/uploads/2012/06/olly91.png"><img class="aligncenter size-full wp-image-274" title="Memory Window" src="wp-content/uploads/2012/06/olly91.png" alt="Memory Window" width="720" height="388" /></a> </p>
<p>You can see that the address we are on (7780B741) falls in the address space of kernel32&#8242;s code section.</p>
<p>Now let&#8217;s go back and view a couple of the other function calls. Re-start the app and F8 down to address 40100C, the line that has the call to GetCommandLineA on it. Click on the instruction and hit the space bar so we can see what address it is pointing to, in this case 4012D0:</p>
<p><a href="wp-content/uploads/2012/06/olly101.png"><img class="aligncenter size-full wp-image-275" title="Assembly Window #2" src="wp-content/uploads/2012/06/olly101.png" alt="Assembly Window #2" width="330" height="112" /></a> </p>
<p>(Sorry for the mouse right over the address <img src='wp-includes/images/smilies/icon_sad.gif' alt=':(' class='wp-smiley' />   It is 4012D0) Now, let&#8217;s try manually going to this address, as this is something you will use often. Either click Ctrl-G or click on the GOTO icon <a href="wp-content/uploads/2012/06/olly112.png"><img class="alignnone size-full wp-image-276" title="olly11" src="wp-content/uploads/2012/06/olly112.png" alt="" width="20" height="21" /></a>  and type in the address we want to go to:</p>
<p style="text-align: center;"><a href="wp-content/uploads/2012/06/olly121.png"><img class="size-full wp-image-277 aligncenter" title="Go to box" src="wp-content/uploads/2012/06/olly121.png" alt="Go to box" width="356" height="152" /></a> </p>
<p>Notice your &#8220;GOTO&#8221; window may look a little different, but that will be fixed soon. Now click OK and we will jump to the jump table for the GetCommandLineA function:</p>
<p style="text-align: center;"><a href="wp-content/uploads/2012/06/olly131.png"><img class="size-full wp-image-278 aligncenter" title="Jump Table #4" src="wp-content/uploads/2012/06/olly131.png" alt="Jump Table #4" width="673" height="119" /></a> </p>
<p>Now click F7 to make the jump and we will land at the beginning of the GetCommandLineA function in kernel32.dll. This function starts at 7C812FBD:</p>
<p style="text-align: center;"><a href="wp-content/uploads/2012/06/olly141.png"><img class="size-full wp-image-280 aligncenter" title="GetCommandLineA" src="wp-content/uploads/2012/06/olly141.png" alt="GetCommandLineA" width="619" height="185" /></a> </p>
<h2><span style="color: #0a77e1;">Jumping in and out of DLLs</span></h2>
<p>As we step around a program, at various times you will end up in DLLs. This is not generally where you want to be if you are trying to overcome some sort of protection scheme as Windows DLLs do not really contain any. The one caveat to this is if the program you are attempting to reverse engineer comes with it&#8217;s own DLLs and you want to reverse those as well (or the protection scheme is actually in a DLL). There are a couple ways to get back to our programs code from a DLL. One way is to simply step through all of the DLL&#8217;s function code until you finally return to your program, though this can take quite a while (and in some cases like Visual Basic, forever). The second option is to go into the &#8220;Debug&#8221; menu option in Olly and choose &#8220;Execute till user code&#8221; or press Alt-F9. This means run the code in this DLL until we return to our own programs code. Keep in mind that sometimes this doesn&#8217;t work because if the DLL accesses a buffer or variable that is in our programs workspace, Olly will stop there, so you could end up calling Alt-F9 several times before you finally get back.</p>
<p>Let&#8217;s try this option now. We should be currently paused at address 7C812FBD, the beginning of GetCommandLineA. Now press Alt-F9. This will take us back to the instruction in our program after the call we made to kernel32 (if you scroll up one line you&#8217;ll see the call).</p>
<p>Now let&#8217;s try another option of getting back to our code. Re-start the program, step over (F8) until the call to GetCommandLineA (40100C), step in to that call (F7) and step in to the jump in the jump table (F7). We are now back at the beginning of GetCommandLineA:</p>
<p><a href="wp-content/uploads/2012/06/olly141.png"><img class="alignnone size-full wp-image-280" title="GetCommandLineA" src="wp-content/uploads/2012/06/olly141.png" alt="GetCommandLineA" width="619" height="185" /></a> </p>
<p>Now open up the memory window and scroll until you can see the sections with our programs code in it (starting at address 400000 with the PE Header):</p>
<p><a href="wp-content/uploads/2012/06/olly151.png"><img class="aligncenter size-full wp-image-281" title="Memory Window 2" src="wp-content/uploads/2012/06/olly151.png" alt="Memory Window 2" width="548" height="301" /></a> </p>
<p>now, click on the line at address 401000, the line that has our .text section on it. Now hit F2 to toggle a breakpoint on access for this memory section (or right click and select Breakpoint on access):</p>
<p><a href="wp-content/uploads/2012/06/olly161.png"><img class="aligncenter size-full wp-image-282" title="Memory Window with Breakpoint" src="wp-content/uploads/2012/06/olly161.png" alt="Memory Window with Breakpoint" width="548" height="301" /></a> </p>
<p>Now, run the app. Olly will break on the same line as above at address 401011, the line one after our call to the DLL!!! Now remove the memory breakpoint or you&#8217;ll wonder why every time you run the app it breaks on the next line <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<h2><span style="color: #0a77e1;">More On The Stack</span></h2>
<p>The stack is a very important part of reverse engineering, and without a very clear understanding of it, you will never be a great reverse engineer. Let&#8217;s experiment with it a little&#8230;</p>
<p>First, take a look at the registers window (after re-starting the app) and look at the ESP register. This register points to the address of the &#8216;top&#8217; of the stack. In this case the value of ESP is 12FFC4. Now look down at the stack window and you&#8217;ll notice the top address in the list matches this address:</p>
<p><a href="wp-content/uploads/2012/06/olly181.png"><img class="aligncenter size-full wp-image-283" title="Stack 1" src="wp-content/uploads/2012/06/olly181.png" alt="Stack 1" width="432" height="192" /></a> </p>
<p>Now push F8 (or F7) one time to push the value zero onto the stack and look at the stack window:</p>
<p><a href="wp-content/uploads/2012/06/olly192.png"><img class="aligncenter size-full wp-image-284" title="Stack 2" src="wp-content/uploads/2012/06/olly192.png" alt="Stack 2" width="432" height="189" /></a> </p>
<p>As we went over in out last tutorial, this pushes zero (null) onto the stack. Now look at our ESP register:</p>
<p><a href="wp-content/uploads/2012/06/olly201.png"><img class="aligncenter size-full wp-image-285" title="Registry Window 1" src="wp-content/uploads/2012/06/olly201.png" alt="Registry Window 1" width="240" height="111" /></a> </p>
<p>It has changed to 12FFc0, because, after pushing a byte onto the stack, this is the new top of the stack. Now press F8 one time, stepping over the call to GetModuleHandleA, and look at the stack window:</p>
<p><a href="wp-content/uploads/2012/06/olly212.png"><img class="aligncenter size-full wp-image-286" title="Stack 3" src="wp-content/uploads/2012/06/olly212.png" alt="Stack 3" width="432" height="190" /></a> </p>
<p>You will notice that our stack has gone back down by one (and our ESP register is back to what it was). This is because the GetModuleHandleA function used this zero that was pushed on to the stack as an argument and then &#8216;pop&#8217;ed it off the stack as it was no longer needed. As was touched on in the last tutorial, this is one way our program passes arguments to functions: they push them on the stack, the called function pops them off the stack, uses them, and then returns, usually with any information we need in registers (as we&#8217;ll see shortly).</p>
<p>Let&#8217;s watch a couple more&#8230;If you press F8 twice to step over the call to GetCommandLineA you will notice that the stack didn&#8217;t change. That&#8217;s because we didn&#8217;t push anything onto the stack for that function to use. Next, we reach a PUSH 0A instruction. This is the first argument that we are going to pass to the next called function. Stepping over this you will notice that 0A will be at the top of the stack and the ESP register has gone down by 4 (when you push a value onto the stack, the ESP register goes down as the stack &#8216;grows&#8217; down in memory). Now push F8 again, and the ESP register will go DOWN again by 4. This is because we have pushed a 4 byte value onto the stack. If you look at the top of the stack you will notice that we pushed 00000000 onto the stack. Why?</p>
<p>Let&#8217;s look at the line that actually made the push at 401013:<br />
<strong>PUSH DWORD PTR DS:[40302c]</strong></p>
<p>What this line means (as I&#8217;m sure you know because you have been studying assembly language :p ) is take the contents of the four bytes at address 40302C and PUSH them onto the stack. What&#8217;s at 40302C? Well, 00000000 of course! (just kidding. Let&#8217;s look for ourselves <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  Right click on the instruction at address 401013 and select &#8220;Follow in Dump&#8221; -&gt; &#8220;Memory Address&#8221;. This will load the dump window with the contents of memory starting at 40302C:</p>
<p><a href="wp-content/uploads/2012/06/olly221.png"><img class="aligncenter size-full wp-image-287" title="Dump Window" src="wp-content/uploads/2012/06/olly221.png" alt="Dump Window" width="452" height="191" /></a> </p>
<p>Obviously, there&#8217;s not much there! But at least you now know where the zero is coming from. If you would like to know more detail as to  what&#8217;s going on here, this memory space is being set up for variables and will eventually be populated with those variables, but for now, all the variables have been initialized to 0&#8242;s.</p>
<p>Now press F8 once and we will be on another PUSH but this time from address 403028. If you scroll up on the dump window you can see that at this address is yet more zeros (right after the string we changed in the last tutorial <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  ). So what this section is doing is pushing pointers to memory addresses, currently set at zero, that our code will use as variables. Step over the last PUSH and step into the call to address 40101C. The first thing you should notice is that something new has been pushed onto the stack: the return address for our call, 401026.</p>
<p>When any code uses a CALL instruction, the address of the next instruction that would have been run had we not made the call is automatically pushed onto the stack. The reason for this is that, after the function we called has done everything it needs to do, it needs to know where to return to. This address that was automatically pushed onto the stack is that return address. Look at the top of the stack window:</p>
<p><a href="wp-content/uploads/2012/06/olly231.png"><img class="aligncenter size-full wp-image-288" title="Stack 4" src="wp-content/uploads/2012/06/olly231.png" alt="Stack 4" width="542" height="81" /></a> </p>
<p>You will see that Olly has figured out that it is a return address and it points back to our program (FirstPro) and that the address that needs to be returned to is 40102C (one instruction past the call).</p>
<p>Now, at the end of this function, a RETN instruction will be used (and of course you know this stands for &#8220;return&#8221; because it was at the beginning of your assembly language book). This return instruction really means &#8220;POP the address of the top of the stack and point our running code to this address&#8221; (it basically replaces the EIP register- the register of the current line of code we are running- with this pop-ed value). So now, the called function knows exactly where it needs to return to when it&#8217;s done! In fact, if you scroll down a little you will see the RETN statement at address 4011A3 that will pop this address off the stack and begin running code at that address:</p>
<p><a href="wp-content/uploads/2012/06/olly241.png"><img class="aligncenter size-full wp-image-305" title="Return address" src="wp-content/uploads/2012/06/olly241.png" alt="Return address" width="619" height="112" /></a> </p>
<p>(The 10 after the RETN statement just means give me the return address and also delete 10h bytes off the stack as I don&#8217;t need them anymore. Just look on the next page of your assembly language book <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  )</p>
<hr style="height: 1px; width: 600px; border-width: 1px; border-style: solid; border-color: #CCCCCC; color: #ffffff;" noshade="noshade" size="1" width="500" />
<p><span style="font-size: 16px;">Let me just take a moment here to start what I am sure will become a famous mantra in the reverse engineering community. I like to call it <strong>&#8220;Random&#8217;s Essential Truths About Reversing Data&#8221;</strong>, or <strong>R.E.T.A.R.D</strong> (since everything sounds better as an acronym). I am officially starting this soon-to-become-legend list with the following commandment:</span></p>
<p style="text-align: center;"><span style="font-size: 18px;"><strong>#1.  You MUST learn assembly language.</strong></span></p>
<p><span style="font-size: 16px;">If you don&#8217;t, you will not succeed at reverse engineering. It&#8217;s that simple.</span></p>
<hr style="height: 1px; width: 500px;" size="1" width="600" />
<p>The last thing I am going to talk about in this tutorial is how Olly handles the displaying of arguments and local variables. If you double click on the EIP register so we can jump back to our current line of code (at address 40101C) and look down a couple lines you will see several blue labels that say Local in them (and one that says Arg):</p>
<p><a href="wp-content/uploads/2012/06/olly251.png"><img class="aligncenter size-full wp-image-307" title="Local variables" src="wp-content/uploads/2012/06/olly251.png" alt="Local variables" width="667" height="130" /></a> </p>
<p>If you do not have any programming experience, you may not know what the difference between a local variable and an argument is. An argument, as we discussed earlier, are variables passed to a function that that function needs, usually passed on the stack. A local variable is a variable that the called function &#8216;creates&#8217; to hold something temporary. Here is an example of a small program that has the two different concepts:</p>
<pre>main()
{
    sayHello( "R4ndom");
}

sayHello( String name)
{
    int numTimes = 3;
    String hello = "Hello, ";

    for( int x = 0; x &lt; numTimes; x++)
        print( hello + name );
}</pre>
<p>In this program, the string &#8220;R4ndom&#8221; is an argument passed into the sayHello function. In normal assembly language, this string (or at least the address of this string) would be pushed on to the stack so that the sayHello function could reference it. Once control transfers to the sayHello function, sayHello needs to set up a couple LOCAL VARIABLES, that is, variables that this function will use but will not be needed once this function is complete.The examples of local variables are the integer numTimes, the string hello, and the integer x. Unfortunately,  just in case the stack was not complicated enough, both arguments and local variables are stored on the stack. The way the stack accomplishes this is by using the ESP register, though this register does not have psychic powers. It normally points to the top of the stack, but it can be modified. So let&#8217;s say we enter the sayHello function and the stack has the following data on it:</p>
<p><strong>1. Address of the string &#8220;R4ndom&#8221;</strong><br />
<strong>2. The return address from the call that got us here.</strong></p>
<p>Well, if we want t0 create a local variable, all we have to do is subtract an amount from the ESP register and this will create space on the stack! Let&#8217;s say we subtract 4 from ESP (which would be 4 bytes, or one 32-bit number). The stack would then look like this:</p>
<p><strong>1. Empty 32-bit number</strong><br />
<strong>2. Address of the string &#8220;R4ndom&#8221;</strong><br />
<strong>3. The return address from the call that got us here.</strong></p>
<p>Now we could put anything we wanted into this address, for instance, we could make it stand for the variable numTimes in our sayHello function. Since our function uses three variables (all 32-bits long) it would really subtract 12 bytes (or 0xC in hex) from ESP and then we would have three local variables that we could use. Here is what the stack may look like then:</p>
<p><strong>1. Empty 32-bit address that points to the string &#8216;hello&#8217;</strong><br />
<strong>2. Empty 32-bit number for variable &#8216;x&#8217;</strong><br />
<strong>3. Empty 32-bit number for  variable &#8216;numTimes&#8217;</strong><br />
<strong>4. Address of the string &#8220;R4ndom&#8221;</strong><br />
<strong>5. The return address from the call that got us here.</strong></p>
<p>Now, sayHello can populate, change, and re-use these addresses to play with our variables, and it still has the argument passed in to this function in the first place (the string &#8220;R4ndom&#8221;). When sayHello is done, it has two ways that it can delete these local variables and arguments (as they will no longer be needed after this function is done) and return the stack back to the way it was: 1) it can change the ESP register back to what it was before we changed it or 2) use a special RETN instruction with a number after it. In the former case, so that the program can remember what the original value of ESP was, it uses another register, EBP, that&#8217;s purpose is to keep track of the original location that the stack pointed to when we first entered the sayHello function. When it&#8217;s ready to return, it simply copies the original value of ESP (stored in EBP at the beginning) out of EBP back into ESP and BAM, the variables are gone. The return address is now at the top of the stack, and when the RETN instruction runs, it will use this tpo get back to our main program.</p>
<p>In the second case, you can tell the CPU how many bytes you don&#8217;t need on the stack anymore, and it will delete these from the top of the stack. In our case, we would use RETN 16 (0xF in hex) and that would get rid of the first 16 bytes (or 4 32-bit numbers) off the top of the stack, leaving the new top of the stack with the return address to get back to our main program. The type of return mechanism used is usually dependent on the compiler, but you will see both.</p>
<p>Now, let&#8217;s look back at our FirstProgram.exe:<br />
<a href="wp-content/uploads/2012/06/olly251.png"><img class="aligncenter size-full wp-image-307" title="Local variables" src="wp-content/uploads/2012/06/olly251.png" alt="Local variables" width="667" height="130" /></a> <br />
You can see that Olly has deciphered one argument and 12 local variables. These local variables are used in our program to keep track of things like the address of our icon, the address of the buffer for our input text, the length of the text input etc. And when it is done, it will either pop these values off, change the ESP register back to EBP or RETN with a number (in this case, it uses all three!!!).</p>
<p>I know that the stack is a very complicated design, but I guarantee that you will start to get the hang of it after messing with it for a while. That book on assembly language will also help a lot <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /> </p>
<p>-till next time</p>
<p>R4ndom</p>
</div>
          	<div class="clr"></div>
          	<span class="linkpages"></span><div class="cleared"></div>
          	
			            
				<div class="roundcornrrbox">
                   	<div class="topleftcorner"><div class="toprightcorner"></div></div>
                    <div class="roubcornrcontent">
            			<span class="posttags-single">No tags</span>
                    	<div class="clr"></div>
                    </div>
                    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
                </div>                        
                        
			
			        	
            <div class="clr"></div>
        </div> <!-- Closes topPost -->
		<small></small>

		<div id="comments">
			            <!-- WP 2.7 and above -->
            <div class="roundcornrrbox">
	<div class="topleftcorner"><div class="toprightcorner"></div></div>
	<div class="roubcornrcontent">

		<h3 id="commentstitle">36 Comments for this entry</h3>
	<ul class="commentlist">
		   <li class="comment even thread-even depth-1" id="li-comment-185">
     <div id="comment-185">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>gdogg</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-185" title="">June 6th, 2012 on 7:43 am</a>  </small>

			<p>Great tut. Few issues:</p>
<p>-You don&#8217;t define x in your sample code (local arguments)<br />
-Your order of the local variables on the stack doesn&#8217;t make sense (But we also can&#8217;t determine them before compiling)<br />
-DLLs doesn&#8217;t need an apostrophe to pluralize it.<br />
-Its as it &#8216;its car is fast&#8217; doesn&#8217;t need an apostrophe<br />
-&#8221;The Reverse Engineers Toolkit&#8221; SHOULD have an apostrophe. &#8220;The Reverse Engineer&#8217;s Toolkit&#8221;</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=185#respond' onclick='return addComment.moveForm("comment-185", "185", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment byuser comment-author-random bypostauthor odd alt thread-odd thread-alt depth-1" id="li-comment-191">
     <div id="comment-191">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-191" title="">June 6th, 2012 on 4:11 pm</a>  </small>

			<p>Wow, an English major in the reverse engineering world! You don&#8217;t come across that very often. Thank you for the input (obviously I am NOT an English major) and I have made your corrections to the tutorial. I appreciate you taking the time to help me improve the tutorial. Especially those DLL&#8217;s!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=191#respond' onclick='return addComment.moveForm("comment-191", "191", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment even thread-even depth-1" id="li-comment-195">
     <div id="comment-195">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Gdogg</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-195" title="">June 6th, 2012 on 11:24 pm</a>  </small>

			<p>Haha no problem. Glad you made the corrections. All you really need to worry about is to continue to pump out these great tuts.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=195#respond' onclick='return addComment.moveForm("comment-195", "195", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-197">
     <div id="comment-197">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/71fe933cf30346c343ef90cac3151da4?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite><a href='https://synapse.wordpress.com/' rel='external nofollow' class='url'>synapse</a> </cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-197" title="">June 7th, 2012 on 4:56 am</a>  </small>

			<p>Another great tutorial! This one is not only good from a reversing point of view but also for understanding x86 architecture and program flow. I especially liked how Jump Tables work and the section on the Stack. Very educational. Thank you.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=197#respond' onclick='return addComment.moveForm("comment-197", "197", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment byuser comment-author-random bypostauthor even depth-2" id="li-comment-203">
     <div id="comment-203">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-203" title="">June 7th, 2012 on 5:10 pm</a>  </small>

			<p>Thanks for the kind words. That&#8217;s one of the things I am hoping to accomplish through this set of tutorials: not just run through the normal flow delivered in most beginning tutorials, but focusing on some areas that are not talked about as much, but are still really interesting.</p>
<p>For instance, within the next couple tutorials I will be going over not only the jump table, but how we can manipulate it into doing other things. This will not only teach more about the inner-workings of the binary, but also is quite fun (not to mention how a lot of viruses work!)</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=203#respond' onclick='return addComment.moveForm("comment-203", "203", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment odd alt depth-3" id="li-comment-205">
     <div id="comment-205">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/71fe933cf30346c343ef90cac3151da4?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite><a href='https://synapse.wordpress.com/' rel='external nofollow' class='url'>synapse</a> </cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-205" title="">June 7th, 2012 on 11:27 pm</a>  </small>

			<p>Sounds great!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=205#respond' onclick='return addComment.moveForm("comment-205", "205", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
</ul>
</li>
   <li class="comment byuser comment-author-ludkiller even thread-even depth-1" id="li-comment-240">
     <div id="comment-240">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='ludkiller' src='wp-content/uploads/2012/06/ludkiller_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite><a href='http://darkl1ght.tk/' rel='external nofollow' class='url'>ludkiller</a> </cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-240" title="">June 10th, 2012 on 3:14 am</a>  </small>

			<p>awesome, nice tutorial again <img src='wp-includes/images/smilies/icon_biggrin.gif' alt=':D' class='wp-smiley' /> </p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=240#respond' onclick='return addComment.moveForm("comment-240", "240", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-1276">
     <div id="comment-1276">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ef89806af31279d09417a080b5ae095d?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>Fl0h</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-1276" title="">July 16th, 2012 on 6:19 pm</a>  </small>

			<p>There&#8217;s no text document on how to install WIN32.hlp into Olly included in the download for this tutorial.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=1276#respond' onclick='return addComment.moveForm("comment-1276", "1276", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment byuser comment-author-random bypostauthor even depth-2" id="li-comment-1284">
     <div id="comment-1284">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-1284" title="">July 16th, 2012 on 8:01 pm</a>  </small>

			<p>Sorry, I just fixed that. You can re-download if you like, though here is all the text file says:</p>
<p>Copy help files into folder in olly.<br />
Select help->Select API Help Files in olly. Point to folder.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=1284#respond' onclick='return addComment.moveForm("comment-1284", "1284", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment odd alt thread-even depth-1" id="li-comment-2488">
     <div id="comment-2488">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Hello</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-2488" title="">August 7th, 2012 on 5:38 pm</a>  </small>

			<p>&#8220;Keep in mind that sometimes this doesn’t work because if the DLL accesses a buffer or variable that is in our programs workspace, Olly will stop there, so you could end up calling Alt-F9 several times before you finally get back.&#8221;</p>
<p>On the normal Olly(the one from the their website), you can&#8217;t press alt+f9 unless the code is in a non-user code area. When it reaches a user code area, hitting alt+f9 just gives a status saying user code reached.</p>
<p>Also pressing alt+f9 skips the extra jumps I stated in the previous post but stops at the real address of the commandlineA dll like in this picture:<br />
<a href="wp-content/uploads/2012/06/olly141.png" rel="nofollow">wp-content/uploads/2012/06/olly141.png</a> </p>
<p>Alt+F9 seems to skip all parts of the code under kernel32. But unlike your OS, my olly defines the real address area of the dlls under KERNELBASE instead of kernel32. The images about the extra jumps that I posted about in my previous post that my 64 bit OS goes through are named kernel32 before it finally reaches the real dll address which is under KERNALBASE</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=2488#respond' onclick='return addComment.moveForm("comment-2488", "2488", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-2801">
     <div id="comment-2801">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/14ba197eff4a0b635958eecd6a0d4543?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>interwound</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-2801" title="">August 14th, 2012 on 4:58 pm</a>  </small>

			<p>When I load the program into Olly the comment section is much sparser. For example it doesn&#8217;t have the first call &#8216;GetModuleHandleA&#8217;. The only one that is showing up is at address 401021, &#8216;FirstProgram&#8217;. I&#8217;m running Olly version 2.00.01 as the previous 1.x versions couldn&#8217;t handle exceptions in Windows 7. Any help fixing this? Great Tutorials.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=2801#respond' onclick='return addComment.moveForm("comment-2801", "2801", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment odd alt depth-2" id="li-comment-2803">
     <div id="comment-2803">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/14ba197eff4a0b635958eecd6a0d4543?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>interwound</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-2803" title="">August 14th, 2012 on 5:06 pm</a>  </small>

			<p>Downloaded version 2.01, and it appears to be working, just ignore me.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=2803#respond' onclick='return addComment.moveForm("comment-2803", "2803", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment even thread-even depth-1" id="li-comment-3427">
     <div id="comment-3427">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/7c6c7cef32aba011c9722b04bda0ee8b?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>Ali</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3427" title="">August 26th, 2012 on 9:41 am</a>  </small>

			<p>I hv a question:</p>
<p>How much i assembly knowldge need to get in to reverse engineering.</p>
<p>without assembly can i crack?</p>
<p>thanx pls reply</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3427#respond' onclick='return addComment.moveForm("comment-3427", "3427", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-3430">
     <div id="comment-3430">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/3da0d72fbbcd5a5af817b1fca846c646?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>drdoom121</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3430" title="">August 26th, 2012 on 10:36 am</a>  </small>

			<p>I just wanted to ask you why do you still use Win Xp?</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3430#respond' onclick='return addComment.moveForm("comment-3430", "3430", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment byuser comment-author-random bypostauthor even depth-2" id="li-comment-3434">
     <div id="comment-3434">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3434" title="">August 26th, 2012 on 4:05 pm</a>  </small>

			<p>When I first started these tuts, I performed them in a virtual machine using Windows XP. Later on, I stopped using the VM, so you will see them switch to Windows 7 64-bit.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3434#respond' onclick='return addComment.moveForm("comment-3434", "3434", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment odd alt depth-3" id="li-comment-3438">
     <div id="comment-3438">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/3da0d72fbbcd5a5af817b1fca846c646?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>drdoom121</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3438" title="">August 26th, 2012 on 7:13 pm</a>  </small>

			<p>&#8221;<br />
 I performed them in a virtual machine using Windows XP.<br />
&#8221;<br />
That&#8217;s what I gussed <img src='wp-includes/images/smilies/icon_wink.gif' alt=';)' class='wp-smiley' /> </p>
<p>I was asking because i wanted to know if the win32api help file (WIN32.HLP in tutorial 4)is still relevant for Windows 7 or not.later i found out that all the win32api calls are backward compatible so i do not need to worry</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3438#respond' onclick='return addComment.moveForm("comment-3438", "3438", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment byuser comment-author-random bypostauthor even depth-2" id="li-comment-3435">
     <div id="comment-3435">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3435" title="">August 26th, 2012 on 4:05 pm</a>  </small>

			<p>You don&#8217;t need to be an expert, but you definitely need to be familiar with it.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3435#respond' onclick='return addComment.moveForm("comment-3435", "3435", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment odd alt thread-even depth-1" id="li-comment-3697">
     <div id="comment-3697">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Anonymous</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3697" title="">September 2nd, 2012 on 1:31 pm</a>  </small>

			<p>Thanks but I think you made a mistake here?</p>
<p>&#8220;Next, we reach a PUSH 0A instruction. This is the first argument that we are going to pass to the next called function. Stepping over this you will notice that 0A will be at the top of the stack and the ESP register has gone down by 2&#8243;</p>
<p>When you push 0A, should the ESP register go down by 4? since by default it pushes DWORDs not WORDs? I even tried it on OllyDbg and indeed it went down by 4.</p>
<p>But other than that one of the great tutorials ever, thanks I wish you eternal happiness.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3697#respond' onclick='return addComment.moveForm("comment-3697", "3697", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment byuser comment-author-random bypostauthor even depth-2" id="li-comment-3741">
     <div id="comment-3741">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3741" title="">September 3rd, 2012 on 4:31 pm</a>  </small>

			<p>Yes, you are absolutely right! A mistake I did no catch. I will fix this in the tutorial, and thank you for your sharp eyes!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3741#respond' onclick='return addComment.moveForm("comment-3741", "3741", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment odd alt depth-3" id="li-comment-3745">
     <div id="comment-3745">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Modnar</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3745" title="">September 3rd, 2012 on 5:26 pm</a>  </small>

			<p>it&#8217;s the least I can do to pay you back, thanks a lot I have learned so much!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3745#respond' onclick='return addComment.moveForm("comment-3745", "3745", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
</ul>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-3936">
     <div id="comment-3936">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>kdma</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3936" title="">September 9th, 2012 on 3:38 pm</a>  </small>

			<p>Great work im following your tutorials after lena&#8217;s and i see that the legacy keeps going <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' />  For the moment i like yours more because you explain more in details certain things i want to see those kinds of details on more advanced stuff.<br />
 also there is a minor error near the end<br />
RETN 16 (0xF in hex)<br />
keep it up</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3936#respond' onclick='return addComment.moveForm("comment-3936", "3936", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment byuser comment-author-random bypostauthor odd alt depth-2" id="li-comment-3942">
     <div id="comment-3942">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-3942" title="">September 9th, 2012 on 7:52 pm</a>  </small>

			<p>Yes, I should probably know that 0F does not equal 16&#8230;</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=3942#respond' onclick='return addComment.moveForm("comment-3942", "3942", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment even thread-even depth-1" id="li-comment-4421">
     <div id="comment-4421">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/b649c22a44c1c5bb99e5f4061fbdf960?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>relhak</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-4421" title="">September 22nd, 2012 on 1:51 am</a>  </small>

			<p>When I use Olly to view the creation of the variables, they all show up as DWORD instead of ARG or LOCAL.  Do you know why that is?</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=4421#respond' onclick='return addComment.moveForm("comment-4421", "4421", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment byuser comment-author-random bypostauthor odd alt depth-2" id="li-comment-4423">
     <div id="comment-4423">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='R4ndom' src='wp-content/uploads/2012/05/R4ndom_avatar-60x60.png' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>R4ndom</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-4423" title="">September 22nd, 2012 on 2:34 am</a>  </small>

			<p><a href="http://www.thelegendofrandom.com/forum/viewtopic.php?f=2&amp;t=15&amp;hilit=arg&amp;start=20" rel="nofollow">http://www.thelegendofrandom.com/forum/viewtopic.php?f=2&#038;t=15&#038;hilit=arg&#038;start=20</a> </p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=4423#respond' onclick='return addComment.moveForm("comment-4423", "4423", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-19473">
     <div id="comment-19473">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/49ab86ae1a709622547ea4c3a26a3ee9?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>blouhoender</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-19473" title="">February 15th, 2013 on 7:08 am</a>  </small>

			<p>Awesome tut&#8230;thanks for all you efforts!</p>
<p>Any advice on seeing the help files in windows 7? If even installed the update from the Microsoft website but it still gives errors?</p>
<p>And why don&#8217;t my version have the blue labels that say [LOCAL.X] or [ARG.X] in them? (Possible dumb question)</p>
<p>Thanks again!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=19473#respond' onclick='return addComment.moveForm("comment-19473", "19473", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment odd alt depth-2" id="li-comment-19474">
     <div id="comment-19474">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>blouhoender</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-19474" title="">February 15th, 2013 on 7:10 am</a>  </small>

			<p>Sorry, ignore the second question&#8230;just saw the post about it.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=19474#respond' onclick='return addComment.moveForm("comment-19474", "19474", "respond", "258")'>Reply</a>       </div>
     </div>
<ul class='children'>
   <li class="comment even depth-3" id="li-comment-78446">
     <div id="comment-78446">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/558ee876aaabadc14982d429d711801c?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>snakep</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-78446" title="">July 26th, 2013 on 10:34 am</a>  </small>

			<p>Couldn&#8217;t find the post on this&#8230; please tell me the URL so I can get the blue labels</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=78446#respond' onclick='return addComment.moveForm("comment-78446", "78446", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
</ul>
</li>
</ul>
</li>
   <li class="comment byuser comment-author-neophyte odd alt thread-even depth-1" id="li-comment-20726">
     <div id="comment-20726">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/d3c465f8ee28a669d820e9f2e3f5638c?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>neophyte</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-20726" title="">February 21st, 2013 on 6:36 am</a>  </small>

			<p>thanks for this great tut. keep up the good work.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=20726#respond' onclick='return addComment.moveForm("comment-20726", "20726", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-24595">
     <div id="comment-24595">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Sleep3r</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-24595" title="">March 13th, 2013 on 6:03 pm</a>  </small>

			<p>If you&#8217;ve OllyDbg 2.0 you can set the help for the API under Options -&gt; Directories -&gt; Location of API help file.</p>
<p>Thank you R4ndom for these amazing tutorials!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=24595#respond' onclick='return addComment.moveForm("comment-24595", "24595", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment odd alt thread-even depth-1" id="li-comment-24603">
     <div id="comment-24603">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Sleep3r</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-24603" title="">March 13th, 2013 on 6:55 pm</a>  </small>

			<p>I&#8217;m using OllyDbg 2.0 and when I press Space I get<br />
    00401002     CALL<br />
instead of<br />
    CALL 004012D6</p>
<p>Anybody knows why?</p>
<p>Thanks in advance.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=24603#respond' onclick='return addComment.moveForm("comment-24603", "24603", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-24604">
     <div id="comment-24604">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Sleep3r</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-24604" title="">March 13th, 2013 on 6:57 pm</a>  </small>

			<p>The Assemble dialog shows the name of the function and the name of the DLL instead the memory address.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=24604#respond' onclick='return addComment.moveForm("comment-24604", "24604", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment odd alt thread-even depth-1" id="li-comment-24608">
     <div id="comment-24608">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=60' class='avatar avatar-60 photo avatar-default' height='60' width='60' />                </a>             
            
			<cite>Sleep3r</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-24608" title="">March 13th, 2013 on 7:02 pm</a>  </small>

			<p>OOPPPSSS!!! I&#8217;ve found it, just behind the Dissasembly zone there&#8217;s the information:</p>
<p>Dest=Tutorial3.004012D6 &#8211; jumps to KERNEL32.GetModuleHandleA</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=24608#respond' onclick='return addComment.moveForm("comment-24608", "24608", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-66231">
     <div id="comment-66231">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/8f307ac4c9d6830146bb0d92a31331e7?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>Khaled</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-66231" title="">May 22nd, 2013 on 1:02 am</a>  </small>

			<p>I&#8217;m really enjoying your tutorials, thank u very much for the hard work, keep up.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=66231#respond' onclick='return addComment.moveForm("comment-66231", "66231", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment byuser comment-author-buttahnbred odd alt thread-even depth-1" id="li-comment-74348">
     <div id="comment-74348">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/130aaa7f4f642531708ab577ea8e2389?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>30-52-44-33-52</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-74348" title="">June 26th, 2013 on 2:21 am</a>  </small>

			<p>Helpful tip for anyone who is stuck getting the help files to work in Windows 7(R).  </p>
<p>1. Select the API file in Ollydbg.  I&#8217;m using the version found in Tutorial 2.<br />
2. Download a supplementary file found on Microsoft&#8217;s website.  Google WinHelp32.hlp.<br />
3. If the two step above doesn&#8217;t solve the problem then you&#8217;ll have to make sure the file is unblocked.  Go to each help file&#8217;s properties window.  Click the &#8220;unblock&#8221; button and the problem should be fixed. </p>
<p>Looking forward to doing this tutorial tomorrow!</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=74348#respond' onclick='return addComment.moveForm("comment-74348", "74348", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment even thread-odd thread-alt depth-1" id="li-comment-78399">
     <div id="comment-78399">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://1.gravatar.com/avatar/5b5b7eb469a44b18af3b5774b88d5aac?s=60&amp;d=http%3A%2F%2F1.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite>Dan</cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-78399" title="">July 26th, 2013 on 5:48 am</a>  </small>

			<p>Great tutorial, but two quick questions.<br />
In olly yours shows LOCAL.X and ARG.X, etc. where x is a number. But mine just show, for example something like: DWORD PTR [EBP-30]<br />
Is this because i&#8217;m using Windows 7 64bit? </p>
<p>And lastly you recommended the art of assembly am I correct for myself learning assembly which your strongly yelling at us to do <img src='wp-includes/images/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /><br />
I saw that you had that on your website, but are you asking us to read all 12 hundred pages or what not of the actual book? What chapters do you strongly recommend I read to understand assembly language?</p>
<p>Thanks<br />
-Dam</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=78399#respond' onclick='return addComment.moveForm("comment-78399", "78399", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
   <li class="comment odd alt thread-even depth-1" id="li-comment-85252">
     <div id="comment-85252">

			<div class="commentbody">
            
                <a class="gravatar">
                	<img alt='' src='http://0.gravatar.com/avatar/cf33b4bf1699ccc7e912d4c617e07260?s=60&amp;d=http%3A%2F%2F0.gravatar.com%2Favatar%2Fad516503a11cd5ca435acc9bb6523536%3Fs%3D60&amp;r=R' class='avatar avatar-60 photo' height='60' width='60' />                </a>             
            
			<cite><a href='http://www.economicscafe.com.sg/' rel='external nofollow' class='url'>jc economics tuition</a> </cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-85252" title="">September 18th, 2013 on 2:04 am</a>  </small>

			<p>Hello just wanted to give you a brief heads up and let you know a few of the images aren&#8217;t loading properly.<br />
I&#8217;m not sure why but I think its a linking issue.<br />
I&#8217;ve tried it in two different internet browsers and both<br />
show the same outcome.</p>
			</div><div class="cleared"></div>

      <div class="reply">
         <a class='comment-reply-link' href='archives/258?replytocom=85252#respond' onclick='return addComment.moveForm("comment-85252", "85252", "respond", "258")'>Reply</a>       </div>
     </div>
</li>
	</ul>
	
	<div class="navigation">
		<div class="alignleft"></div>
		<div class="alignright"></div>
		<div class="cleared"></div>
	</div>

		<h3>1 Trackback or Pingback for this entry</h3>
	<ul class="trackback">
		     <li class="pingback even thread-even depth-1" id="li-comment-776">
     <div id="comment-776">
			<div class="commentbody">
			<cite><a href='http://msg1len.wordpress.com/2012/07/03/using-olly-part-2/' rel='external nofollow' class='url'>Using Olly, Part 2 | msg1len Official Website</a> </cite> 
						<br />
			<small class="commentmetadata"><a href="#comment-776" title="">July 3rd, 2012 on 4:59 am</a>  </small>

			<p>[...]     Original Post  Share this:TwitterFacebookLike this:LikeBe the first to like this.   This entry was posted in [...]</p>
			</div>
     </div>
</li>
	</ul>
	

 
<div class="clr"></div>
<div id="respond">
<h3>Leave a Reply</h3>
<div id="cancel-comment-reply">
	<small><a rel="nofollow" id="cancel-comment-reply-link" href="archives/258#respond">Click here to cancel reply.</a> </small>
</div>
 
<form action="http://thelegendofrandom.com/blog/wp-comments-post.php" method="post" id="commentform">


<p><input type="text" name="author" id="author" value="" size="22" tabindex="1" />
<label for="author"><small>Name </small></label></p>
<p><input type="text" name="email" id="email" value="" size="22" tabindex="2" />
<label for="email"><small>Mail (will not be published) </small></label></p>
<p><input type="text" name="url" id="url" value="" size="22" tabindex="3" />
<label for="url"><small>Website</small></label></p>

 <input type='hidden' name='comment_post_ID' value='258' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='2803' />

<!--<p><small><strong>XHTML:</strong> You can use these tags: &lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </small></p>-->
<p><textarea name="comment" id="comment" cols="56" rows="10" tabindex="4"></textarea></p>
<p><input name="submit" type="submit" id="submit" class="submitbutton" tabindex="5" value="Leave comment" />
<input type="hidden" name="comment_post_ID" value="258" />
</p>

<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="8ab371eb45" /></p> 
</form>
</div>
 
    </div>
    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
</div>            
                    </div> <!-- Closes Comment -->

<div id="extrastuff">
<span id="rssleft"><a href='archives/258/feed'><abbr title="Really Simple Syndication">RSS</abbr> feed for this post (comments)</a> </span>

<span id="trackright"> &#183; <a href="archives/258/trackback" rel="trackback">TrackBack <abbr title="Uniform Resource Identifier">URI</abbr></a> </span>
<div class="cleared"></div>
</div>


</div><!-- Closes Main -->


<div id="rightcol">
	<div class="roundcornrrbox">
    <div class="topleftcorner"><div class="toprightcorner"></div></div>
    <div class="roundcrrcnt">
        <!-- Optional Intro -->
                
        <!-- widget -->



<h2>Login</h2>
<form action="http://thelegendofrandom.com/blog/wp-login.php" method="post">
<input type="text" name="log" id="log" value="" size="20" />
<input type="password" name="pwd" id="pwd" size="20" />
<input type="submit" name="submit" value="Send" class="button" />
    <p>
       <label for="rememberme"><input name="rememberme" id="rememberme" type="checkbox" checked="checked" value="forever" /> Remember me</label>
       <input type="hidden" name="redirect_to" value="/blog/archives/258?replytocom=2803" />
    </p>
</form>
<a href="http://thelegendofrandom.com/blog/wp-login.php?action=lostpassword">Recover password</a> 



        		<li id="recent-posts-2" class="sidebaritem widget_recent_entries"><div class="sidebarbox">		<h2 class="widgettitle">Recent Posts</h2>		<ul>
					<li>
				<a href="archives/2980" title="My Absence">My Absence</a> 
						</li>
					<li>
				<a href="archives/2975" title="What Are These Strange Posts?">What Are These Strange Posts?</a> 
						</li>
					<li>
				<a href="archives/2966" title="Nice Beginning Article on Reversing Android">Nice Beginning Article on Reversing Android</a> 
						</li>
					<li>
				<a href="archives/2963" title="She Is 17-years-old, She Did It Publicly In High School And While Drunk">She Is 17-years-old, She Did It Publicly In High School And While Drunk</a> 
						</li>
					<li>
				<a href="archives/2961" title="And The Most Posts Submitted In A Single Sitting Goes To&#8230;">And The Most Posts Submitted In A Single Sitting Goes To&#8230;</a> 
						</li>
				</ul>
		</div></li><li id="recent-comments-2" class="sidebaritem widget_recent_comments"><div class="sidebarbox"><h2 class="widgettitle">Recent Comments</h2><ul id="recentcomments"><li class="recentcomments"><a href='http://www.economicscafe.com.sg/' rel='external nofollow' class='url'>jc economics tuition</a>  on <a href="archives/258#comment-85252">Tutorial #4: Using Olly, Part 2</a> </li><li class="recentcomments">Ray on <a href="archives/654#comment-85087">R4ndom&#8217;s Tutorial #9: No Strings Attached</a> </li><li class="recentcomments">equal on <a href="archives/506#comment-84987">Tutorial #8: Frame Of Reference</a> </li><li class="recentcomments">Deeren on <a href="archives/2420#comment-84709">R4ndom’s Guide to RadASM: Installing and Set Up</a> </li><li class="recentcomments">Abutharik on <a href="archives/833#comment-84487">R4ndom&#8217;s Tutorial #10: The Levels Of Patching</a> </li></ul></div></li><li id="archives-2" class="sidebaritem widget_archive"><div class="sidebarbox"><h2 class="widgettitle">Archives</h2>		<ul>
			<li><a href='archives/date/2012/10' title='October 2012'>October 2012</a> </li>
	<li><a href='archives/date/2012/09' title='September 2012'>September 2012</a> </li>
	<li><a href='archives/date/2012/08' title='August 2012'>August 2012</a> </li>
	<li><a href='archives/date/2012/07' title='July 2012'>July 2012</a> </li>
	<li><a href='archives/date/2012/06' title='June 2012'>June 2012</a> </li>
	<li><a href='archives/date/2012/05' title='May 2012'>May 2012</a> </li>
		</ul>
</div></li><li id="categories-2" class="sidebaritem widget_categories"><div class="sidebarbox"><h2 class="widgettitle">Categories</h2>		<ul>
	<li class="cat-item cat-item-23"><a href="archives/category/beginner" title="View all posts filed under Beginner">Beginner</a> 
</li>
	<li class="cat-item cat-item-31"><a href="archives/category/challenges" title="View all posts filed under Challenges">Challenges</a> 
</li>
	<li class="cat-item cat-item-24"><a href="archives/category/intermediate" title="View all posts filed under Intermediate">Intermediate</a> 
</li>
	<li class="cat-item cat-item-32"><a href="archives/category/modifying-binaries" title="View all posts filed under Modifying Binaries">Modifying Binaries</a> 
</li>
	<li class="cat-item cat-item-25"><a href="archives/category/randoms-ramblings" title="View all posts filed under Random&#039;s Ramblings">Random&#039;s Ramblings</a> 
</li>
	<li class="cat-item cat-item-3"><a href="archives/category/reverse-engineering" title="View all posts filed under Reverse Engineering">Reverse Engineering</a> 
</li>
	<li class="cat-item cat-item-4"><a href="archives/category/tools" title="View all posts filed under Tools">Tools</a> 
</li>
	<li class="cat-item cat-item-5"><a href="archives/category/tutorials" title="View all posts filed under Tutorials">Tutorials</a> 
</li>
	<li class="cat-item cat-item-1"><a href="archives/category/uncategorized" title="View all posts filed under Uncategorized">Uncategorized</a> 
</li>
		</ul>
</div></li><li id="meta-2" class="sidebaritem widget_meta"><div class="sidebarbox"><h2 class="widgettitle">Meta</h2>			<ul>
			<li><a href="http://thelegendofrandom.com/blog/wp-login.php?action=register">Register</a> </li>			<li><a href="http://thelegendofrandom.com/blog/wp-login.php">Log in</a> </li>
			<li><a href="feed" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a> </li>
						<li><a href="http://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a> </li>
						</ul>
</div></li><li id="ajax-quick-subscribe" class="sidebaritem widget_quick_subscribe"><div class="sidebarbox"><h2 class="widgettitle">Subscribe</h2>Enter your email to subscribe to future updates<div id="QSWidgetDiv" class="QSWidgetDiv"><form name='widget_quick_subscribe_form' id='widget_quick_subscribe_form'><input type='email' name='QS_user_email_widget' id='QS_user_email_widget' placeholder='email@email.com' onFocus='fadeSubmitIn("widget_qsSubmit");' onBlur='fadeSubmitOut(this, "widget_qsSubmit");'  onkeypress='return checkForEnter(event, "QS_user_email_widget", "QSWidgetDiv"); return false;'><input style='display:none;' type='button' value='subscribe!' id='widget_qsSubmit' class='widget_qsSubmit' onClick='submitQuickSubscribe("QS_user_email_widget", "QSWidgetDiv");'></form></div>			
			</div></li> 

        <div class="clr"></div>

    	<div id="feedbox">
            <div id="contrssbox">
                <a href="feed">RSS Feed</a> 
            </div>
        </div>
        


    </div>
    <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
</div>
</div>
<div class="clr"></div>




    
	<div id="bottompanel">
    <div class="roundcornrrbox">
        <div class="topleftcorner"><div class="toprightcorner"></div></div>
        <div class="roundcrrcnt">
        
        	
            <div class="col1">
                
					                    <h3>Recent Posts</h3>
                    <ul>
                                                    <li>
                                <a href="archives/2980">My Absence </a> 
                            </li>
                                                    <li>
                                <a href="archives/2975">What Are These Strange Posts? </a> 
                            </li>
                                                    <li>
                                <a href="archives/2966">Nice Beginning Article on Reversing Android </a> 
                            </li>
                                                    <li>
                                <a href="archives/2963">She Is 17-years-old, She Did It Publicly In High School And While Drunk </a> 
                            </li>
                                                    <li>
                                <a href="archives/2961">And The Most Posts Submitted In A Single Sitting Goes To&#8230; </a> 
                            </li>
                        			
                    </ul>
                    

                            </div>
            
            <div class="col2">
                      
                    <h3>Archives</h3>
                    <ul>
                        	<li><a href='archives/date/2012/10' title='October 2012'>October 2012</a> </li>
	<li><a href='archives/date/2012/09' title='September 2012'>September 2012</a> </li>
	<li><a href='archives/date/2012/08' title='August 2012'>August 2012</a> </li>
	<li><a href='archives/date/2012/07' title='July 2012'>July 2012</a> </li>
	<li><a href='archives/date/2012/06' title='June 2012'>June 2012</a> </li>
                    </ul>

                            </div>
            
            <div class="col3">
                                    <h3>Tags</h3>
                    <ul>
                    	<a href='archives/tag/adding-functionality' class='tag-link-29' title='1 topic' style='font-size: 8pt;'>adding functionality</a> 
<a href='archives/tag/assembly-language' class='tag-link-18' title='1 topic' style='font-size: 8pt;'>assembly language</a> 
<a href='archives/tag/binary' class='tag-link-26' title='1 topic' style='font-size: 8pt;'>binary</a> 
<a href='archives/tag/code-cave' class='tag-link-27' title='1 topic' style='font-size: 8pt;'>code cave</a> 
<a href='archives/tag/code-caves' class='tag-link-30' title='1 topic' style='font-size: 8pt;'>code caves</a> 
<a href='archives/tag/cracking' class='tag-link-8' title='5 topics' style='font-size: 16pt;'>cracking</a> 
<a href='archives/tag/crackme' class='tag-link-17' title='1 topic' style='font-size: 8pt;'>crackme</a> 
<a href='archives/tag/ebook' class='tag-link-19' title='1 topic' style='font-size: 8pt;'>ebook</a> 
<a href='archives/tag/exploting-binaries' class='tag-link-28' title='1 topic' style='font-size: 8pt;'>exploting binaries</a> 
<a href='archives/tag/guide' class='tag-link-15' title='1 topic' style='font-size: 8pt;'>Guide</a> 
<a href='archives/tag/olly' class='tag-link-14' title='2 topics' style='font-size: 11pt;'>Olly</a> 
<a href='archives/tag/ollydbg' class='tag-link-10' title='4 topics' style='font-size: 14.666666666667pt;'>ollydbg</a> 
<a href='archives/tag/olly-tutorial' class='tag-link-9' title='1 topic' style='font-size: 8pt;'>olly tutorial</a> 
<a href='archives/tag/plugins' class='tag-link-11' title='1 topic' style='font-size: 8pt;'>plugins</a> 
<a href='archives/tag/reverse-engineering-2' class='tag-link-7' title='3 topics' style='font-size: 13pt;'>reverse engineering</a> 
<a href='archives/tag/sandbox' class='tag-link-13' title='1 topic' style='font-size: 8pt;'>sandbox</a> 
<a href='archives/tag/tools' class='tag-link-4' title='1 topic' style='font-size: 8pt;'>Tools</a> 
<a href='archives/tag/tutorial' class='tag-link-16' title='2 topics' style='font-size: 11pt;'>tutorial</a>                     </ul>
                    
                            </div>
            <div class="clr"></div>
        

            <div class="clr"></div>
        </div>
        <div class="bottomleftcorner"><div class="bottomrightcorner"></div></div>
    </div>
</div>
<!-- Bottom Panel ends -->


	
    <div class="copyr">Copyright &copy; 1996-2010 The Legend Of Random. All rights reserved.</div>    
    <div class="clr16"></div>
	</div>
    <div id="layoutbottom"></div>
</div>

<div id="credit" align="center">
	<abbr title="Jarrah/1.7">Jarrah</abbr> theme by <a href="http://www.templatesnext.org/">Templates Next</a>  
    | Powered by <a href="http://wordpress.org/">WordPress</a>  
</div>


</body>

<!-- Mirrored from thelegendofrandom.com/blog/archives/258?replytocom=2803 by HTTrack Website Copier/3.x [XR&CO'2013], Thu, 19 Sep 2013 11:04:55 GMT -->
</html>